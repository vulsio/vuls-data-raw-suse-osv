{
	"id": "SUSE-SU-2022:2595-1",
	"modified": "2022-07-29T14:00:50Z",
	"published": "2022-07-29T14:00:50Z",
	"related": [
		"CVE-2022-31741"
	],
	"summary": "Security update for mozilla-nss",
	"details": "This update for mozilla-nss fixes the following issues:\n\nVarious FIPS 140-3 related fixes were backported from SUSE Linux Enterprise 15 SP4:\n\n- Makes the PBKDF known answer test compliant with NIST SP800-132. (bsc#1192079). \n- FIPS: Add on-demand integrity tests through sftk_FIPSRepeatIntegrityCheck()\n  (bsc#1198980).\n- FIPS: mark algorithms as approved/non-approved according to security policy\n  (bsc#1191546, bsc#1201298).\n- FIPS: remove hard disabling of unapproved algorithms. This requirement is now\n  fulfilled by the service level indicator (bsc#1200325).\n- Run test suite at build time, and make it pass (bsc#1198486).\n- FIPS: skip algorithms that are hard disabled in FIPS mode.\n- Prevent expired PayPalEE cert from failing the tests.\n- Allow checksumming to be disabled, but only if we entered FIPS mode\n  due to NSS_FIPS being set, not if it came from /proc.\n- FIPS: Make the PBKDF known answer test compliant with NIST SP800-132.\n- Update FIPS validation string to version-release format.\n- FIPS: remove XCBC MAC from list of FIPS approved algorithms.\n- Enable NSS_ENABLE_FIPS_INDICATORS and set NSS_FIPS_MODULE_ID\n  for build.\n- FIPS: claim 3DES unapproved in FIPS mode (bsc#1192080).\n- FIPS: allow testing of unapproved algorithms (bsc#1192228).\n- FIPS: add version indicators. (bmo#1729550, bsc#1192086).\n- FIPS: fix some secret clearing (bmo#1697303, bsc#1192087).\n\nVersion update to NSS 3.79:\n\n- Use PK11_GetSlotInfo instead of raw C_GetSlotInfo calls.\n- Update mercurial in clang-format docker image.\n- Use of uninitialized pointer in lg_init after alloc fail.\n- selfserv and tstclnt should use PR_GetPrefLoopbackAddrInfo.\n- Add SECMOD_LockedModuleHasRemovableSlots.\n- Fix secasn1d parsing of indefinite SEQUENCE inside indefinite GROUP.\n- Added RFC8422 compliant TLS <= 1.2 undefined/compressed ECPointFormat extension alerts.\n- TLS 1.3 Server: Send protocol_version alert on unsupported ClientHello.legacy_version.\n- Correct invalid record inner and outer content type alerts.\n- NSS does not properly import or export pkcs12 files with large passwords and pkcs5v2 encoding.\n- improve error handling after nssCKFWInstance_CreateObjectHandle.\n- Initialize pointers passed to NSS_CMSDigestContext_FinishMultiple.\n- NSS 3.79 should depend on NSPR 4.34   \n\nVersion update to NSS 3.78.1:\n\n- Initialize pointers passed to NSS_CMSDigestContext_FinishMultiple\n\nVersion update to NSS 3.78:\n\n- Added TLS 1.3 zero-length inner plaintext checks and tests, zero-length record/fragment handling tests.\n- Reworked overlong record size checks and added TLS1.3 specific boundaries.\n- Add ECH Grease Support to tstclnt\n- Add a strict variant of moz::pkix::CheckCertHostname.\n- Change SSL_REUSE_SERVER_ECDHE_KEY default to false.\n- Make SEC_PKCS12EnableCipher succeed\n- Update zlib in NSS to 1.2.12.\n\nVersion update to NSS 3.77:\n\n- Fix link to TLS page on wireshark wiki\n- Add two D-TRUST 2020 root certificates.\n- Add Telia Root CA v2 root certificate.\n- Remove expired explicitly distrusted certificates from certdata.txt.\n- support specific RSA-PSS parameters in mozilla::pkix\n- Remove obsolete stateEnd check in SEC_ASN1DecoderUpdate.\n- Remove token member from NSSSlot struct.\n- Provide secure variants of mpp_pprime and mpp_make_prime.\n- Support UTF-8 library path in the module spec string.\n- Update nssUTF8_Length to RFC 3629 and fix buffer overrun.\n- Update googletest to 1.11.0\n- Add SetTls13GreaseEchSize to experimental API.\n- TLS 1.3 Illegal legacy_version handling/alerts.\n- Fix calculation of ECH HRR Transcript.\n- Allow ld path to be set as environment variable.\n- Ensure we don't read uninitialized memory in ssl gtests.\n- Fix DataBuffer Move Assignment.\n- internal_error alert on Certificate Request with sha1+ecdsa in TLS 1.3\n- rework signature verification in mozilla::pkix\n\nVersion update to NSS 3.76.1\n\n- Remove token member from NSSSlot struct.\n- Hold tokensLock through nssToken_GetSlot calls in nssTrustDomain_GetActiveSlots.\n- Check return value of PK11Slot_GetNSSToken.\n- Use Wycheproof JSON for RSASSA-PSS\n- Add SHA256 fingerprint comments to old certdata.txt entries.\n- Avoid truncating files in nss-release-helper.py.\n- Throw illegal_parameter alert for illegal extensions in handshake message.\n\nVersion update to NSS 3.75\n\n- Make DottedOIDToCode.py compatible with python3.\n- Avoid undefined shift in SSL_CERT_IS while fuzzing.\n- Remove redundant key type check.\n- Update ABI expectations to match ECH changes.\n- Enable CKM_CHACHA20.\n- check return on NSS_NoDB_Init and NSS_Shutdown.\n- Run ECDSA test vectors from bltest as part of the CI tests.\n- Add ECDSA test vectors to the bltest command line tool.\n- Allow to build using clang's integrated assembler.\n- Allow to override python for the build.\n- test HKDF output rather than input.\n- Use ASSERT macros to end failed tests early.\n- move assignment operator for DataBuffer.\n- Add test cases for ECH compression and unexpected extensions in SH.\n- Update tests for ECH-13.\n- Tidy up error handling.\n- Add tests for ECH HRR Changes.\n- Server only sends GREASE HRR extension if enabled by preference.\n- Update generation of the Associated Data for ECH-13.\n- When ECH is accepted, reject extensions which were only advertised in the Outer Client Hello.\n- Allow for compressed, non-contiguous, extensions.\n- Scramble the PSK extension in CHOuter.\n- Split custom extension handling for ECH.\n- Add ECH-13 HRR Handling.\n- Client side ECH padding.\n- Stricter ClientHelloInner Decompression.\n- Remove ECH_inner extension, use new enum format.\n- Update the version number for ECH-13 and adjust the ECHConfig size.\n\nVersion update to NSS 3.74\n\n- mozilla::pkix: support SHA-2 hashes in CertIDs in OCSP responses\n- Ensure clients offer consistent ciphersuites after HRR\n- NSS does not properly restrict server keys based on policy\n- Set nssckbi version number to 2.54\n- Replace Google Trust Services LLC (GTS) R4 root certificate\n- Replace Google Trust Services LLC (GTS) R3 root certificate\n- Replace Google Trust Services LLC (GTS) R2 root certificate\n- Replace Google Trust Services LLC (GTS) R1 root certificate\n- Replace GlobalSign ECC Root CA R4\n- Remove Expired Root Certificates - DST Root CA X3\n- Remove Expiring Cybertrust Global Root and GlobalSign root certificates\n- Add renewed Autoridad de Certificacion Firmaprofesional CIF A62634068 root certificate\n- Add iTrusChina ECC root certificate\n- Add iTrusChina RSA root certificate\n- Add ISRG Root X2 root certificate\n- Add Chunghwa Telecom's HiPKI Root CA - G1 root certificate\n- Avoid a clang 13 unused variable warning in opt build\n- Check for missing signedData field\n- Ensure DER encoded signatures are within size limits\n\n- enable key logging option (boo#1195040)\n\nVersion update to NSS 3.73.1:\n\n- Add SHA-2 support to mozilla::pkix's OSCP implementation\n\nVersion update to NSS 3.73\n\n- check for missing signedData field.\n- Ensure DER encoded signatures are within size limits.\n- NSS needs FiPS 140-3 version indicators.\n- pkix_CacheCert_Lookup doesn't return cached certs\n- sunset Coverity from NSS\n\nFixed MFSA 2021-51 (bsc#1193170) CVE-2021-43527: Memory corruption via DER-encoded DSA and RSA-PSS signatures\n\nVersion update to NSS 3.72\n\n- Fix nsinstall parallel failure.\n- Increase KDF cache size to mitigate perf regression in about:logins\n\nVersion update to NSS 3.71\n\n- Set nssckbi version number to 2.52.\n- Respect server requirements of tlsfuzzer/test-tls13-signature-algorithms.py\n- Import of PKCS#12 files with Camellia encryption is not supported\n- Add HARICA Client ECC Root CA 2021.\n- Add HARICA Client RSA Root CA 2021.\n- Add HARICA TLS ECC Root CA 2021.\n- Add HARICA TLS RSA Root CA 2021.\n- Add TunTrust Root CA certificate to NSS.\n\nVersion update to NSS 3.70\n\n- Update test case to verify fix.\n- Explicitly disable downgrade check in TlsConnectStreamTls13.EchOuterWith12Max\n- Explicitly disable downgrade check in TlsConnectTest.DisableFalseStartOnFallback\n- Avoid using a lookup table in nssb64d.\n- Use HW accelerated SHA2 on AArch64 Big Endian.\n- Change default value of enableHelloDowngradeCheck to true.\n- Cache additional PBE entries.\n- Read HPKE vectors from official JSON.\n\nVersion update to NSS 3.69.1:\n\n- Disable DTLS 1.0 and 1.1 by default\n- integrity checks in key4.db not happening on private components with AES_CBC\n\nNSS 3.69:\n\n- Disable DTLS 1.0 and 1.1 by default (backed out again)\n- integrity checks in key4.db not happening on private components with AES_CBC (backed out again)\n- SSL handling of signature algorithms ignores environmental invalid algorithms.\n- sqlite 3.34 changed it's open semantics, causing nss failures.\n- Gtest update changed the gtest reports, losing gtest details in all.sh reports.\n- NSS incorrectly accepting 1536 bit DH primes in FIPS mode\n- SQLite calls could timeout in starvation situations.\n- Coverity/cpp scanner errors found in nss 3.67\n- Import the NSS documentation from MDN in nss/doc.\n- NSS using a tempdir to measure sql performance not active\n\nVersion Update to 3.68.4 (bsc#1200027)\n\n- CVE-2022-31741: Initialize pointers passed to NSS_CMSDigestContext_FinishMultiple.  (bmo#1767590)\n\n\n",
	"affected": [
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Module for Basesystem 15 SP4",
				"name": "mozilla-nss",
				"purl": "purl:rpm/suse/mozilla-nss&distro=SUSE%20Linux%20Enterprise%20Module%20for%20Basesystem%2015%20SP4"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "3.79-150400.3.7.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"libfreebl3": "3.79-150400.3.7.1",
						"libfreebl3-32bit": "3.79-150400.3.7.1",
						"libfreebl3-hmac": "3.79-150400.3.7.1",
						"libfreebl3-hmac-32bit": "3.79-150400.3.7.1",
						"libsoftokn3": "3.79-150400.3.7.1",
						"libsoftokn3-32bit": "3.79-150400.3.7.1",
						"libsoftokn3-hmac": "3.79-150400.3.7.1",
						"libsoftokn3-hmac-32bit": "3.79-150400.3.7.1",
						"mozilla-nss": "3.79-150400.3.7.1",
						"mozilla-nss-32bit": "3.79-150400.3.7.1",
						"mozilla-nss-certs": "3.79-150400.3.7.1",
						"mozilla-nss-certs-32bit": "3.79-150400.3.7.1",
						"mozilla-nss-devel": "3.79-150400.3.7.1",
						"mozilla-nss-sysinit": "3.79-150400.3.7.1",
						"mozilla-nss-tools": "3.79-150400.3.7.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "openSUSE:Leap 15.4",
				"name": "mozilla-nss",
				"purl": "purl:rpm/suse/mozilla-nss&distro=openSUSE%20Leap%2015.4"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "3.79-150400.3.7.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"libfreebl3": "3.79-150400.3.7.1",
						"libfreebl3-32bit": "3.79-150400.3.7.1",
						"libfreebl3-hmac": "3.79-150400.3.7.1",
						"libfreebl3-hmac-32bit": "3.79-150400.3.7.1",
						"libsoftokn3": "3.79-150400.3.7.1",
						"libsoftokn3-32bit": "3.79-150400.3.7.1",
						"libsoftokn3-hmac": "3.79-150400.3.7.1",
						"libsoftokn3-hmac-32bit": "3.79-150400.3.7.1",
						"mozilla-nss": "3.79-150400.3.7.1",
						"mozilla-nss-32bit": "3.79-150400.3.7.1",
						"mozilla-nss-certs": "3.79-150400.3.7.1",
						"mozilla-nss-certs-32bit": "3.79-150400.3.7.1",
						"mozilla-nss-devel": "3.79-150400.3.7.1",
						"mozilla-nss-sysinit": "3.79-150400.3.7.1",
						"mozilla-nss-sysinit-32bit": "3.79-150400.3.7.1",
						"mozilla-nss-tools": "3.79-150400.3.7.1"
					}
				]
			}
		}
	],
	"references": [
		{
			"type": "ADVISORY",
			"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20222595-1/"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1192079"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1192080"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1192086"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1192087"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1192228"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1198486"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200027"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-31741"
		}
	]
}
