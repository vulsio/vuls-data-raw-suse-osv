{
	"id": "SUSE-SU-2022:3810-1",
	"modified": "2022-10-31T08:30:34Z",
	"published": "2022-10-31T08:30:34Z",
	"related": [
		"CVE-2022-20008",
		"CVE-2022-2503",
		"CVE-2022-3169",
		"CVE-2022-3239",
		"CVE-2022-3303",
		"CVE-2022-3424",
		"CVE-2022-40307",
		"CVE-2022-40768",
		"CVE-2022-41218",
		"CVE-2022-41848"
	],
	"summary": "Security update for the Linux Kernel",
	"details": "\nThe SUSE Linux Enterprise 12 SP5 kernel rt was updated.\n\nThe following security bugs were fixed:\n\n- CVE-2022-40768: Fixed information leak in the scsi driver which allowed local users to obtain sensitive information from kernel memory. (bnc#1203514)\n- CVE-2022-3169: Fixed a denial of service flaw which occurs when consecutive requests to NVME_IOCTL_RESET and the NVME_IOCTL_SUBSYS_RESET are sent. (bnc#1203290)\n- CVE-2022-3303: Fixed a race condition in the sound subsystem due to improper locking (bnc#1203769).\n- CVE-2022-41218: Fixed an use-after-free caused by refcount races in drivers/media/dvb-core/dmxdev.c (bnc#1202960).\n- CVE-2022-3239: Fixed an use-after-free in the video4linux driver that could lead a local user to able to crash the system or escalate their privileges (bnc#1203552).\n- CVE-2022-41848: Fixed a race condition and resultant use-after-free if a physically proximate attacker removes a PCMCIA device while calling ioctl (bnc#1203987).\n- CVE-2022-2503: Fixed a bug in dm-verity, device-mapper table reloads allowed users with root privileges to switch out the target with an equivalent dm-linear target and bypass verification till reboot. This allowed root to bypass LoadPin and can be used to load untrusted and unverified kernel modules and firmware, which implies arbitrary kernel execution and persistence for peripherals that do not verify firmware updates (bnc#1202677).\n- CVE-2022-20008: Fixed a bug which allowed to read kernel heap memory due to uninitialized data. This could lead to local information disclosure if reading from an SD card that triggers errors, with no additional execution privileges needed. (bnc#1199564)\n- CVE-2022-40307: Fixed a race condition that could had been exploited to trigger a use-after-free in the efi firmware capsule-loader.c. (bnc#1203322)\n- CVE-2022-3424: Fixed a use-after-free in gru_set_context_option which was leading to kernel panic. (bsc#1204166)\n\nThe following non-security bugs were fixed:\n\n- ACPI: processor idle: Practically limit 'Dummy wait' workaround to old Intel systems (bnc#1203802).\n- ACPI: processor_idle: Skip dummy wait if kernel is in guest (bnc#1203802).\n- arm64: cpufeature: Allow different PMU versions in ID_DFR0_EL1 (git-fixes)\n- cifs: alloc_mid function should be marked as static (bsc#1190317).\n- cifs: alloc_path_with_tree_prefix: do not append sep. if the path is empty (bsc#1190317).\n- cifs: change smb2_query_info_compound to use a cached fid, if available (bsc#1190317).\n- cifs: check for smb1 in open_cached_dir() (bsc#1190317).\n- cifs: Check the IOCB_DIRECT flag, not O_DIRECT (bsc#1190317).\n- cifs: clean up an inconsistent indenting (bsc#1190317).\n- cifs: convert the path to utf16 in smb2_query_info_compound (bsc#1190317).\n- cifs: Do not use tcon->cfid directly, use the cfid we get from open_cached_dir (bsc#1190317).\n- cifs: do not use uninitialized data in the owner/group sid (bsc#1190317).\n- cifs: fix double free race when mount fails in cifs_get_root() (bsc#1190317).\n- cifs: fix FILE_BOTH_DIRECTORY_INFO definition (bsc#1190317).\n- cifs: fix handlecache and multiuser (bsc#1190317).\n- cifs: fix lock length calculation (bsc#1190317).\n- cifs: fix ntlmssp auth when there is no key exchange (bsc#1190317).\n- cifs: fix NULL ptr dereference in refresh_mounts() (bsc#1190317).\n- cifs: fix NULL ptr dereference in smb2_ioctl_query_info() (bsc#1190317).\n- cifs: fix set of group SID via NTSD xattrs (bsc#1190317).\n- cifs: fix signed integer overflow when fl_end is OFFSET_MAX (bsc#1190317).\n- cifs: Fix smb311_update_preauth_hash() kernel-doc comment (bsc#1190317).\n- cifs: fix the cifs_reconnect path for DFS (bsc#1190317).\n- cifs: fix uninitialized pointer in error case in dfs_cache_get_tgt_share (bsc#1190317).\n- cifs: mark sessions for reconnection in helper function (bsc#1190317).\n- cifs: modefromsids must add an ACE for authenticated users (bsc#1190317).\n- cifs: move definition of cifs_fattr earlier in cifsglob.h (bsc#1190317).\n- cifs: move from strlcpy with unused retval to strscpy (bsc#1190317).\n- cifs: move superblock magic defitions to magic.h (bsc#1190317).\n- cifs: potential buffer overflow in handling symlinks (bsc#1190317).\n- cifs: prevent bad output lengths in smb2_ioctl_query_info() (bsc#1190317).\n- cifs: release cached dentries only if mount is complete (bsc#1190317).\n- cifs: remove 'cifs_' prefix from init/destroy mids functions (bsc#1190317).\n- cifs: remove check of list iterator against head past the loop body (bsc#1190317).\n- cifs: remove minor build warning (bsc#1190317).\n- cifs: remove redundant initialization to variable mnt_sign_enabled (bsc#1190317).\n- cifs: remove remaining build warnings (bsc#1190317).\n- cifs: remove repeated debug message on cifs_put_smb_ses() (bsc#1190317).\n- cifs: remove some camelCase and also some static build warnings (bsc#1190317).\n- cifs: remove unnecessary (void*) conversions (bsc#1190317).\n- cifs: remove unused server parameter from calc_smb_size() (bsc#1190317).\n- cifs: remove useless DeleteMidQEntry() (bsc#1190317).\n- cifs: remove useless parameter 'is_fsctl' from SMB2_ioctl() (bsc#1190317).\n- cifs: return errors during session setup during reconnects (bsc#1190317).\n- cifs: return the more nuanced writeback error on close() (bsc#1190317).\n- cifs: sanitize multiple delimiters in prepath (bsc#1190317).\n- cifs: set the CREATE_NOT_FILE when opening the directory in use_cached_dir() (bsc#1190317).\n- cifs: skip trailing separators of prefix paths (bsc#1190317).\n- cifs: smbd: fix typo in comment (bsc#1190317).\n- cifs: Split the smb3_add_credits tracepoint (bsc#1190317).\n- cifs: use correct lock type in cifs_reconnect() (bsc#1190317).\n- cifs: Use kzalloc instead of kmalloc/memset (bsc#1190317).\n- cifs: verify that tcon is valid before dereference in cifs_kill_sb (bsc#1190317).\n- cifs: version operations for smb20 unneeded when legacy support disabled (bsc#1190317).\n- cifs: we do not need a spinlock around the tree access during umount (bsc#1190317).\n- cifs: when extending a file with falloc we should make files not-sparse (bsc#1190317).\n- dm: thin metadata: Fix use-after-free in dm_bm_set_read_only (bsc#1203462).\n- dtb: Do not include sources in src.rpm - refer to kernel-source Same as other kernel binary packages there is no need to carry duplicate sources in dtb packages.\n- fbdev: fb_pm2fb: Avoid potential divide by zero error (bsc#1154048)\n- ftrace: Fix NULL pointer dereference in is_ftrace_trampoline when ftrace is dead (git-fixes).\n- Input: iforce - constify usb_device_id and fix space before '[' error (git-fixes).\n- Input: melfas_mip4 - fix return value check in mip4_probe() (git-fixes).\n- Input: stop telling users to snail-mail Vojtech (git-fixes).\n- KVM: x86/emulator: Fix handing of POP SS to correctly set interruptibility (git-fixes).\n- locking/csd_lock: Change csdlock_debug from early_param to __setup (git-fixes).\n- md-raid10: fix KASAN warning (git-fixes).\n- md: call __md_stop_writes in md_stop (git-fixes).\n- mkspec: eliminate @NOSOURCE@ macro This should be alsways used with @SOURCES@, just include the content there.\n- net: mana: Add rmb after checking owner bits (git-fixes).\n- net: mana: Add the Linux MANA PF driver (bug#1201309, jsc#PED-529).\n- NFS: LOOKUP_DIRECTORY is also ok with symlinks (git-fixes).\n- NFSD: Fix zero-length NFSv3 WRITEs (git-fixes).\n- NFSv4.1: RECLAIM_COMPLETE must handle EACCES (git-fixes).\n- powerpc: Use device_type helpers to access the node type (bsc#1203424 ltc#199544).\n- powerpc/drmem: Make lmb_size 64 bit (bsc#1203424 ltc#199544).\n- powerpc/memhotplug: Make lmb size 64bit (bsc#1203424 ltc#199544).\n- ppc64/kdump: Limit kdump base to 512MB (bsc#1203410 ltc#199904).\n- s390: fix double free of GS and RI CBs on fork() failure (bsc#1203254 LTC#199911).\n- s390/guarded storage: simplify task exit handling (bsc#1203254 LTC#199911).\n- s390/hugetlb: fix prepare_hugepage_range() check for 2 GB hugepages (bsc#1203142 LTC#199883).\n- s390/hypfs: avoid error message under KVM (bsc#1032323).\n- s390/mm: do not trigger write fault when vma does not allow VM_WRITE (bsc#1203198 LTC#199898).\n- scsi: ch: Make it possible to open a ch device multiple times again (git-fixes).\n- scsi: core: Avoid that a kernel warning appears during system resume (git-fixes).\n- scsi: core: Avoid that system resume triggers a kernel warning (git-fixes).\n- scsi: fcoe: Embed fc_rport_priv in fcoe_rport structure (git-fixes).\n- scsi: lpfc: Add missing destroy_workqueue() in error path (git-fixes).\n- scsi: lpfc: Check the return value of alloc_workqueue() (git-fixes).\n- scsi: mpt3sas: Do not call disable_irq from IRQ poll handler (git-fixes).\n- scsi: mpt3sas: Fix ioctl timeout (git-fixes).\n- scsi: mpt3sas: Fix sync irqs (git-fixes).\n- scsi: mpt3sas: Fix use-after-free warning (git-fixes).\n- scsi: qla2xxx: Add debugfs create/delete helpers (bsc#1203935).\n- scsi: qla2xxx: Add NVMe parameters support in Auxiliary Image Status (bsc#1203935).\n- scsi: qla2xxx: Always wait for qlt_sess_work_fn() from qlt_stop_phase1() (bsc#1203935).\n- scsi: qla2xxx: Avoid flush_scheduled_work() usage (bsc#1203935).\n- scsi: qla2xxx: Disable ATIO interrupt coalesce for quad port ISP27XX (bsc#1203935).\n- scsi: qla2xxx: Drop DID_TARGET_FAILURE use (bsc#1203935).\n- scsi: qla2xxx: Fix memory leak in __qlt_24xx_handle_abts() (bsc#1203935).\n- scsi: qla2xxx: Fix memory leak in __qlt_24xx_handle_abts() (git-fixes).\n- scsi: qla2xxx: Fix response queue handler reading stale packets (bsc#1203935).\n- scsi: qla2xxx: Log message 'skipping scsi_scan_host()' as informational (bsc#1203935).\n- scsi: qla2xxx: Remove unused declarations for qla2xxx (bsc#1203935).\n- scsi: qla2xxx: Remove unused del_sess_list field (bsc#1203935).\n- scsi: qla2xxx: Remove unused qlt_tmr_work() (bsc#1203935).\n- scsi: qla2xxx: Revert 'scsi: qla2xxx: Fix response queue handler reading stale packets' (bsc#1203935).\n- scsi: qla2xxx: Update version to 10.02.07.900-k (bsc#1203935).\n- scsi: sd_zbc: Fix compilation warning (git-fixes).\n- scsi: sd: enable compat ioctls for sed-opal (git-fixes).\n- scsi: sd: Fix Opal support (git-fixes).\n- scsi: sg: Allow waiting for commands to complete on removed device (git-fixes).\n- scsi: smartpqi: Fix DMA direction for RAID requests (git-fixes).\n- smb2: small refactor in smb2_check_message() (bsc#1190317).\n- smb3: add trace point for SMB2_set_eof (bsc#1190317).\n- smb3: check for null tcon (bsc#1190317).\n- smb3: check xattr value length earlier (bsc#1190317).\n- smb3: do not set rc when used and unneeded in query_info_compound (bsc#1190317).\n- smb3: EBADF/EIO errors in rename/open caused by race condition in smb2_compound_op (bsc#1190317).\n- SUNRPC: Reinitialise the backchannel request buffers before reuse (git-fixes).\n- sysfb: Enable boot time VESA graphic mode selection (bsc#1129770) Backporting notes: \t* context changes \t* config update\n- USB: Add ignore-residue quirk for NXP PN7462AU (git-fixes).\n- USB: cdc-acm: Add Icom PMR F3400 support (0c26:0020) (git-fixes).\n- USB: core: Prevent nested device-reset calls (git-fixes).\n- USB: dwc2: fix wrong order of phy_power_on and phy_init (git-fixes).\n- USB: serial: ftdi_sio: add Belimo device ids (git-fixes).\n- USB: serial: option: add Quectel BG95 0x0203 composition (git-fixes).\n- USB: serial: option: add Quectel EM05-G modem (git-fixes).\n- USB: serial: option: add Quectel RM500K module support.\n- USB: serial: option: add Quectel RM520N (git-fixes).\n- USB: serial: option: add support for Cinterion MV31 with new baseline (git-fixes).\n- USB: serial: option: add Telit LE910Cx 0x1250 composition (git-fixes).\n- USB: typec: altmodes/displayport: correct pin assignment for UFP receptacles (git-fixes).\n- USB: typec: tcpci: Do not skip cleanup in .remove() on error (git-fixes).\n- USB: struct usb_device: hide new member (git-fixes).\n- USB: Fix memory leak in usbnet_disconnect() (git-fixes).\n- video: fbdev: amba-clcd: Fix refcount leak bugs (bsc#1154048) Backporting notes: \t* context changes\n- video: fbdev: arkfb: Check the size of screen before memset_io() (bsc#1154048)\n- video: fbdev: arkfb: Fix a divide-by-zero bug in ark_set_pixclock() (bsc#1154048)\n- video: fbdev: s3fb: Check the size of screen before memset_io() (bsc#1154048)\n- video: fbdev: sis: fix typos in SiS_GetModeID() (bsc#1154048)\n- video: fbdev: vt8623fb: Check the size of screen before memset_io() (bsc#1154048)\n- x86/bugs: Reenable retbleed=off While for older kernels the return thunks are statically built in and cannot be dynamically patched out, retbleed=off should still be possible to do so that the mitigation can still be disabled on Intel who do not use the return thunks but IBRS.\n- x86/xen: Remove undefined behavior in setup_features() (git-fixes).\n- xhci: bail out early if driver can't accress host in resume (git-fixes).\n",
	"affected": [
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Real Time 12 SP5",
				"name": "kernel-rt",
				"purl": "purl:rpm/suse/kernel-rt&distro=SUSE%20Linux%20Enterprise%20Real%20Time%2012%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.12.14-10.103.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"cluster-md-kmp-rt": "4.12.14-10.103.1",
						"dlm-kmp-rt": "4.12.14-10.103.1",
						"gfs2-kmp-rt": "4.12.14-10.103.1",
						"kernel-devel-rt": "4.12.14-10.103.1",
						"kernel-rt": "4.12.14-10.103.1",
						"kernel-rt-base": "4.12.14-10.103.1",
						"kernel-rt-devel": "4.12.14-10.103.1",
						"kernel-rt_debug": "4.12.14-10.103.1",
						"kernel-rt_debug-devel": "4.12.14-10.103.1",
						"kernel-source-rt": "4.12.14-10.103.1",
						"kernel-syms-rt": "4.12.14-10.103.1",
						"ocfs2-kmp-rt": "4.12.14-10.103.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Real Time 12 SP5",
				"name": "kernel-rt_debug",
				"purl": "purl:rpm/suse/kernel-rt_debug&distro=SUSE%20Linux%20Enterprise%20Real%20Time%2012%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.12.14-10.103.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"cluster-md-kmp-rt": "4.12.14-10.103.1",
						"dlm-kmp-rt": "4.12.14-10.103.1",
						"gfs2-kmp-rt": "4.12.14-10.103.1",
						"kernel-devel-rt": "4.12.14-10.103.1",
						"kernel-rt": "4.12.14-10.103.1",
						"kernel-rt-base": "4.12.14-10.103.1",
						"kernel-rt-devel": "4.12.14-10.103.1",
						"kernel-rt_debug": "4.12.14-10.103.1",
						"kernel-rt_debug-devel": "4.12.14-10.103.1",
						"kernel-source-rt": "4.12.14-10.103.1",
						"kernel-syms-rt": "4.12.14-10.103.1",
						"ocfs2-kmp-rt": "4.12.14-10.103.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Real Time 12 SP5",
				"name": "kernel-source-rt",
				"purl": "purl:rpm/suse/kernel-source-rt&distro=SUSE%20Linux%20Enterprise%20Real%20Time%2012%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.12.14-10.103.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"cluster-md-kmp-rt": "4.12.14-10.103.1",
						"dlm-kmp-rt": "4.12.14-10.103.1",
						"gfs2-kmp-rt": "4.12.14-10.103.1",
						"kernel-devel-rt": "4.12.14-10.103.1",
						"kernel-rt": "4.12.14-10.103.1",
						"kernel-rt-base": "4.12.14-10.103.1",
						"kernel-rt-devel": "4.12.14-10.103.1",
						"kernel-rt_debug": "4.12.14-10.103.1",
						"kernel-rt_debug-devel": "4.12.14-10.103.1",
						"kernel-source-rt": "4.12.14-10.103.1",
						"kernel-syms-rt": "4.12.14-10.103.1",
						"ocfs2-kmp-rt": "4.12.14-10.103.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Real Time 12 SP5",
				"name": "kernel-syms-rt",
				"purl": "purl:rpm/suse/kernel-syms-rt&distro=SUSE%20Linux%20Enterprise%20Real%20Time%2012%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.12.14-10.103.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"cluster-md-kmp-rt": "4.12.14-10.103.1",
						"dlm-kmp-rt": "4.12.14-10.103.1",
						"gfs2-kmp-rt": "4.12.14-10.103.1",
						"kernel-devel-rt": "4.12.14-10.103.1",
						"kernel-rt": "4.12.14-10.103.1",
						"kernel-rt-base": "4.12.14-10.103.1",
						"kernel-rt-devel": "4.12.14-10.103.1",
						"kernel-rt_debug": "4.12.14-10.103.1",
						"kernel-rt_debug-devel": "4.12.14-10.103.1",
						"kernel-source-rt": "4.12.14-10.103.1",
						"kernel-syms-rt": "4.12.14-10.103.1",
						"ocfs2-kmp-rt": "4.12.14-10.103.1"
					}
				]
			}
		}
	],
	"references": [
		{
			"type": "ADVISORY",
			"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223810-1/"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1032323"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1124235"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1129770"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1154048"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1190317"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1199564"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1201309"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1202385"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1202677"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1202960"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1203142"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1203198"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1203254"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1203290"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1203322"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1203410"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1203424"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1203462"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1203514"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1203552"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1203769"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1203802"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1203935"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1203987"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1204166"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-20008"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-2503"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-3169"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-3239"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-3303"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-3424"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-40307"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-40768"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-41218"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-41848"
		}
	]
}
