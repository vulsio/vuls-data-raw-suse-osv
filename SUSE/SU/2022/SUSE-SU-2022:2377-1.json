{
	"id": "SUSE-SU-2022:2377-1",
	"modified": "2022-07-12T16:24:12Z",
	"published": "2022-07-12T16:24:12Z",
	"related": [
		"CVE-2020-26541",
		"CVE-2021-4157",
		"CVE-2022-1012",
		"CVE-2022-1679",
		"CVE-2022-20132",
		"CVE-2022-20141",
		"CVE-2022-20154",
		"CVE-2022-2318",
		"CVE-2022-26365",
		"CVE-2022-29900",
		"CVE-2022-29901",
		"CVE-2022-33740",
		"CVE-2022-33741",
		"CVE-2022-33742",
		"CVE-2022-33981"
	],
	"summary": "Security update for the Linux Kernel",
	"details": "The SUSE Linux Enterprise 12 SP5 kernel was updated to receive various security and bugfixes.\n\n\nThe following security bugs were fixed:\n\n- CVE-2022-29900, CVE-2022-29901: Fixed the RETBLEED attack, a new Spectre like Branch Target Buffer attack, that can leak arbitrary kernel information (bsc#1199657).\n- CVE-2022-1679: Fixed a use-after-free in the Atheros wireless driver in the way a user forces the ath9k_htc_wait_for_target function to fail with some input messages (bsc#1199487).\n- CVE-2022-20132: Fixed out of bounds read due to improper input validation in lg_probe and related functions of hid-lg.c (bsc#1200619).\n- CVE-2022-1012: Fixed information leak caused by small table perturb size in the TCP source port generation algorithm (bsc#1199482).\n- CVE-2022-33981: Fixed use-after-free in floppy driver (bsc#1200692)\n- CVE-2022-20141: Fixed a possible use after free due to improper locking in ip_check_mc_rcu() (bsc#1200604).\n- CVE-2021-4157: Fixed an out of memory bounds write flaw in the NFS subsystem, related to the replication of files with NFS. A user could potentially crash the system or escalate privileges on the system (bsc#1194013).\n- CVE-2022-20154: Fixed a use after free due to a race condition in lock_sock_nested of sock.c. This could lead to local escalation of privilege with System execution privileges needed (bsc#1200599).\n- CVE-2020-26541: Enforce the secure boot forbidden signature database (aka dbx) protection mechanism. (bsc#1177282)\n- CVE-2022-2318: Fixed a use-after-free vulnerabilities in the timer handler in net/rose/rose_timer.c that allow attackers to crash the system without any privileges (bsc#1201251).\n- CVE-2022-26365, CVE-2022-33740, CVE-2022-33741, CVE-2022-33742: Fixed multiple potential data leaks with Block and Network devices when using untrusted backends (bsc#1200762).\n\nThe following non-security bugs were fixed:\n\n- audit: fix a race condition with the auditd tracking code (bsc#1197170).\n- block: bio-integrity: Advance seed correctly for larger interval sizes (git-fixes).\n- bnxt_en: Remove the setting of dev_port (git-fixes).\n- bonding: fix bond_neigh_init() (git-fixes).\n- dm crypt: Avoid percpu_counter spinlock contention in crypt_page_alloc() (git-fixes).\n- drbd: fix duplicate array initializer (git-fixes).\n- drbd: remove assign_p_sizes_qlim (git-fixes).\n- drbd: use bdev_alignment_offset instead of queue_alignment_offset (git-fixes).\n- drbd: use bdev based limit helpers in drbd_send_sizes (git-fixes).\n- exec: Force single empty string when argv is empty (bsc#1200571).\n- ext4: fix bug_on ext4_mb_use_inode_pa (bsc#1200810).\n- ext4: fix bug_on in __es_tree_search (bsc#1200809).\n- ext4: fix bug_on in ext4_writepages (bsc#1200872).\n- ext4: fix overhead calculation to account for the reserved gdt blocks (bsc#1200869).\n- ext4: fix race condition between ext4_write and ext4_convert_inline_data (bsc#1200807).\n- ext4: fix symlink file size not match to file content (bsc#1200868).\n- ext4: fix use-after-free in ext4_rename_dir_prepare (bsc#1200871).\n- ext4: force overhead calculation if the s_overhead_cluster makes no sense (bsc#1200870).\n- ext4: limit length to bitmap_maxbytes - blocksize in punch_hole (bsc#1200806).\n- ext4: make variable 'count' signed (bsc#1200820).\n- fs-writeback: writeback_sb_inodes Recalculate 'wrote' according skipped pages (bsc#1200873).\n- i915_vma: Rename vma_lookup to i915_vma_lookup (git-fixes).\n- ibmvnic: Properly dispose of all skbs during a failover (bsc#1200925).\n- init: Initialize noop_backing_dev_info early (bsc#1200822).\n- inotify: show inotify mask flags in proc fdinfo (bsc#1200600).\n- Input: bcm5974 - set missing URB_NO_TRANSFER_DMA_MAP urb flag (git-fixes).\n- Input: elan_i2c - fix regulator enable count imbalance after suspend/resume (git-fixes).\n- Input: elan_i2c - move regulator_[en|dis]able() out of elan_[en|dis]able_power() (git-fixes).\n- Input: omap4-keypad - fix pm_runtime_get_sync() error checking (git-fixes).\n- iomap: iomap_write_failed fix (bsc#1200829).\n- kvm: fix wrong exception emulation in check_rdtsc (git-fixes).\n- kvm: i8254: remove redundant assignment to pointer s (git-fixes).\n- KVM: LAPIC: Prevent setting the tscdeadline timer if the lapic is hw disabled (git-fixes).\n- KVM: s390: vsie/gmap: reduce gmap_rmap overhead (git-fixes).\n- KVM: x86: Allocate new rmap and large page tracking when moving memslot (git-fixes).\n- KVM: x86: always stop emulation on page fault (git-fixes).\n- KVM: x86: clear stale x86_emulate_ctxt->intercept value (git-fixes).\n- KVM: x86: clflushopt should be treated as a no-op by emulation (git-fixes).\n- kvm: x86/cpuid: Only provide CPUID leaf 0xA if host has architectural PMU (git-fixes).\n- KVM: x86: Do not force set BSP bit when local APIC is managed by userspace (git-fixes).\n- KVM: x86: do not modify masked bits of shared MSRs (git-fixes).\n- KVM: x86/emulator: Defer not-present segment check in __load_segment_descriptor() (git-fixes).\n- KVM: x86: Fix emulation in writing cr8 (git-fixes).\n- KVM: x86: Fix off-by-one error in kvm_vcpu_ioctl_x86_setup_mce (git-fixes).\n- KVM: x86: Fix potential put_fpu() w/o load_fpu() on MPX platform (git-fixes).\n- KVM: x86: Fix x86_decode_insn() return when fetching insn bytes fails (git-fixes).\n- KVM: x86: Free wbinvd_dirty_mask if vCPU creation fails (git-fixes).\n- kvm: x86: Improve emulation of CPUID leaves 0BH and 1FH (git-fixes).\n- KVM: x86: Inject #GP if guest attempts to toggle CR4.LA57 in 64-bit mode (git-fixes).\n- KVM: x86: Manually calculate reserved bits when loading PDPTRS (git-fixes).\n- KVM: x86: Manually flush collapsible SPTEs only when toggling flags (git-fixes).\n- KVM: x86: Migrate the PIT only if vcpu0 is migrated, not any BSP (git-fixes).\n- KVM: x86/mmu: Treat invalid shadow pages as obsolete (git-fixes).\n- KVM: x86: Refactor prefix decoding to prevent Spectre-v1/L1TF attacks (git-fixes).\n- KVM: x86: Remove spurious clearing of async #PF MSR (git-fixes).\n- KVM: x86: Remove spurious kvm_mmu_unload() from vcpu destruction path (git-fixes).\n- KVM: x86: remove stale comment from struct x86_emulate_ctxt (git-fixes).\n- KVM: x86: set ctxt->have_exception in x86_decode_insn() (git-fixes).\n- kvm: x86: skip populating logical dest map if apic is not sw enabled (git-fixes).\n- KVM: x86: Trace the original requested CPUID function in kvm_cpuid() (git-fixes).\n- KVM: x86: Update vCPU's hv_clock before back to guest when tsc_offset is adjusted (git-fixes).\n- md: bcache: check the return value of kzalloc() in detached_dev_do_request() (git-fixes).\n- md: fix an incorrect NULL check in does_sb_need_changing (git-fixes).\n- md: fix an incorrect NULL check in md_reload_sb (git-fixes).\n- md/raid0: Ignore RAID0 layout if the second zone has only one device (git-fixes).\n- mm: add vma_lookup(), update find_vma_intersection() comments (git-fixes).\n- net/mlx5: Avoid double free of root ns in the error flow path (git-fixes).\n- net/mlx5e: Replace reciprocal_scale in TX select queue function (git-fixes).\n- net/mlx5e: Switch to Toeplitz RSS hash by default (git-fixes).\n- net/mlx5: Fix auto group size calculation (git-fixes).\n- net: qed: Disable aRFS for NPAR and 100G (git-fixes).\n- net: qede: Disable aRFS for NPAR and 100G (git-fixes).\n- net: stmmac: update rx tail pointer register to fix rx dma hang issue (git-fixes).\n- NFSD: Fix possible sleep during nfsd4_release_lockowner() (git-fixes).\n- NFS: Further fixes to the writeback error handling (git-fixes).\n- PCI/ACPI: Allow D3 only if Root Port can signal and wake from D3 (git-fixes).\n- PCI: Tidy comments (git-fixes).\n- platform/chrome: cros_ec_proto: Send command again when timeout occurs (git-fixes).\n- powerpc/idle: Fix return value of __setup() handler (bsc#1065729).\n- powerpc/perf: Fix the threshold compare group constraint for power9 (bsc#1065729).\n- powerpc/rtas: Allow ibm,platform-dump RTAS call with null buffer address (bsc#1200343 ltc#198477).\n- qed: Enable automatic recovery on error condition (bsc#1196964).\n- raid5: introduce MD_BROKEN (git-fixes).\n- s390: fix detection of vector enhancements facility 1 vs. vector packed decimal facility (git-fixes).\n- s390: fix strrchr() implementation (git-fixes).\n- s390/ftrace: fix ftrace_update_ftrace_func implementation (git-fixes).\n- s390/gmap: do not unconditionally call pte_unmap_unlock() in __gmap_zap() (git-fixes).\n- s390/gmap: validate VMA in __gmap_zap() (git-fixes).\n- s390/mm: fix VMA and page table handling code in storage key handling functions (git-fixes).\n- s390/mm: validate VMA in PGSTE manipulation functions (git-fixes).\n- scsi: dc395x: Fix a missing check on list iterator (git-fixes).\n- scsi: ufs: qcom: Add a readl() to make sure ref_clk gets enabled (git-fixes).\n- scsi: ufs: qcom: Fix ufs_qcom_resume() (git-fixes).\n- SUNRPC: Fix the calculation of xdr->end in xdr_get_next_encode_buffer() (git-fixes).\n- target: remove an incorrect unmap zeroes data deduction (git-fixes).\n- tracing: Fix return value of trace_pid_write() (git-fixes).\n- usb: musb: Fix missing of_node_put() in omap2430_probe (git-fixes).\n- USB: serial: option: add Quectel BG95 modem (git-fixes).\n- USB: storage: karma: fix rio_karma_init return (git-fixes).\n- usb: usbip: add missing device lock on tweak configuration cmd (git-fixes).\n- usb: usbip: fix a refcount leak in stub_probe() (git-fixes).\n- video: fbdev: clcdfb: Fix refcount leak in clcdfb_of_vram_setup (bsc#1129770)\n- writeback: Avoid skipping inode writeback (bsc#1200813).\n- writeback: Fix inode->i_io_list not be protected by inode->i_lock error (bsc#1200821).\n",
	"affected": [
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server 12 SP5",
				"name": "kernel-azure",
				"purl": "purl:rpm/suse/kernel-azure&distro=SUSE%20Linux%20Enterprise%20Server%2012%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.12.14-16.103.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"kernel-azure": "4.12.14-16.103.1",
						"kernel-azure-base": "4.12.14-16.103.1",
						"kernel-azure-devel": "4.12.14-16.103.1",
						"kernel-devel-azure": "4.12.14-16.103.1",
						"kernel-source-azure": "4.12.14-16.103.1",
						"kernel-syms-azure": "4.12.14-16.103.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server 12 SP5",
				"name": "kernel-source-azure",
				"purl": "purl:rpm/suse/kernel-source-azure&distro=SUSE%20Linux%20Enterprise%20Server%2012%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.12.14-16.103.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"kernel-azure": "4.12.14-16.103.1",
						"kernel-azure-base": "4.12.14-16.103.1",
						"kernel-azure-devel": "4.12.14-16.103.1",
						"kernel-devel-azure": "4.12.14-16.103.1",
						"kernel-source-azure": "4.12.14-16.103.1",
						"kernel-syms-azure": "4.12.14-16.103.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server 12 SP5",
				"name": "kernel-syms-azure",
				"purl": "purl:rpm/suse/kernel-syms-azure&distro=SUSE%20Linux%20Enterprise%20Server%2012%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.12.14-16.103.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"kernel-azure": "4.12.14-16.103.1",
						"kernel-azure-base": "4.12.14-16.103.1",
						"kernel-azure-devel": "4.12.14-16.103.1",
						"kernel-devel-azure": "4.12.14-16.103.1",
						"kernel-source-azure": "4.12.14-16.103.1",
						"kernel-syms-azure": "4.12.14-16.103.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server for SAP Applications 12 SP5",
				"name": "kernel-azure",
				"purl": "purl:rpm/suse/kernel-azure&distro=SUSE%20Linux%20Enterprise%20Server%20for%20SAP%20Applications%2012%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.12.14-16.103.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"kernel-azure": "4.12.14-16.103.1",
						"kernel-azure-base": "4.12.14-16.103.1",
						"kernel-azure-devel": "4.12.14-16.103.1",
						"kernel-devel-azure": "4.12.14-16.103.1",
						"kernel-source-azure": "4.12.14-16.103.1",
						"kernel-syms-azure": "4.12.14-16.103.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server for SAP Applications 12 SP5",
				"name": "kernel-source-azure",
				"purl": "purl:rpm/suse/kernel-source-azure&distro=SUSE%20Linux%20Enterprise%20Server%20for%20SAP%20Applications%2012%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.12.14-16.103.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"kernel-azure": "4.12.14-16.103.1",
						"kernel-azure-base": "4.12.14-16.103.1",
						"kernel-azure-devel": "4.12.14-16.103.1",
						"kernel-devel-azure": "4.12.14-16.103.1",
						"kernel-source-azure": "4.12.14-16.103.1",
						"kernel-syms-azure": "4.12.14-16.103.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server for SAP Applications 12 SP5",
				"name": "kernel-syms-azure",
				"purl": "purl:rpm/suse/kernel-syms-azure&distro=SUSE%20Linux%20Enterprise%20Server%20for%20SAP%20Applications%2012%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.12.14-16.103.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"kernel-azure": "4.12.14-16.103.1",
						"kernel-azure-base": "4.12.14-16.103.1",
						"kernel-azure-devel": "4.12.14-16.103.1",
						"kernel-devel-azure": "4.12.14-16.103.1",
						"kernel-source-azure": "4.12.14-16.103.1",
						"kernel-syms-azure": "4.12.14-16.103.1"
					}
				]
			}
		}
	],
	"references": [
		{
			"type": "ADVISORY",
			"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20222377-1/"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1065729"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1129770"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1177282"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1194013"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1196964"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1197170"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1199482"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1199487"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1199657"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200343"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200571"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200599"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200600"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200604"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200605"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200608"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200619"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200692"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200762"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200806"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200807"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200809"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200810"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200813"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200820"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200821"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200822"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200829"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200868"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200869"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200870"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200871"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200872"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200873"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200925"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1201080"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1201251"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2020-26541"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2021-4157"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-1012"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-1679"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-20132"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-20141"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-20154"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-2318"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-26365"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-29900"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-29901"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-33740"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-33741"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-33742"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-33981"
		}
	]
}
