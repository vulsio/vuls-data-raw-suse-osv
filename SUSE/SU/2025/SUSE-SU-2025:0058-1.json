{
	"id": "SUSE-SU-2025:0058-1",
	"modified": "2025-01-10T07:34:53Z",
	"published": "2025-01-10T07:34:53Z",
	"related": [
		"CVE-2024-50379",
		"CVE-2024-52317",
		"CVE-2024-54677"
	],
	"summary": "Security update for tomcat",
	"details": "This update for tomcat fixes the following issues:\n\nUpdate to Tomcat 9.0.98\n\n- Fixed CVEs:\n  + CVE-2024-54677: DoS in examples web application (bsc#1234664)\n  + CVE-2024-50379: RCE due to TOCTOU issue in JSP compilation (bsc#1234663)\n  + CVE-2024-52317: Request/response mix-up with HTTP/2 (bsc#1233435)\n- Catalina\n  + Add: Add option to serve resources from subpath only with WebDAV Servlet\n    like with DefaultServlet. (michaelo)\n  + Fix: Add special handling for the protocols attribute of SSLHostConfig in\n    storeconfig. (remm)\n  + Fix: 69442: Fix case sensitive check on content-type when parsing request\n    parameters. (remm)\n  + Code: Refactor duplicate code for extracting media type and subtype from\n    content-type into a single method. (markt)\n  + Fix: Compatibility of generated embedded code with components where\n    constructors or property related methods throw a checked exception. (remm)\n  + Fix: The previous fix for inconsistent resource metadata during concurrent\n    reads and writes was incomplete. (markt)\n  + Fix: 69444: Ensure that the javax.servlet.error.message request attribute\n    is set when an application defined error page is called. (markt)\n  + Fix: Avoid quotes for numeric values in the JSON generated by the status\n    servlet. (remm)\n  + Add: Add strong ETag support for the WebDAV and default servlet, which can\n    be enabled by using the useStrongETags init parameter with a value set to\n    true. The ETag generated will be a SHA-1 checksum of the resource content.\n    (remm)\n  + Fix: Use client locale for directory listings. (remm)\n  + Fix: 69439: Improve the handling of multiple Cache-Control headers in the\n    ExpiresFilter. Based on pull request #777 by Chenjp. (markt)\n  + Fix: 69447: Update the support for caching classes the web application\n    class loader cannot find to take account of classes loaded from external\n    repositories. Prior to this fix, these classes could be incorrectly marked\n    as not found. (markt)\n  + Fix: 69466: Rework handling of HEAD requests. Headers explicitly set by\n    users will not be removed and any header present in a HEAD request will\n    also be present in the equivalent GET request. There may be some headers,\n    as per RFC 9110, section 9.3.2, that are present in a GET request that are\n    not present in the equivalent HEAD request. (markt)\n  + Fix: 69471: Log instances of CloseNowException caught by\n    ApplicationDispatcher.invoke() at debug level rather than error level as\n    they are very likely to have been caused by a client disconnection or\n    similar I/O issue. (markt)\n  + Add: Add a test case for the fix for 69442. Also refactor references to\n    application/x-www-form-urlencoded. Based on pull request #779 by Chenjp.\n    (markt)\n  + Fix: 69476: Catch possible ISE when trying to report PUT failure in the\n    DefaultServlet. (remm)\n  + Add: Add support for RateLimit header fields for HTTP (draft) in the\n    RateLimitFilter. Based on pull request #775 provided by Chenjp. (markt)\n  + Add: #787: Add regression tests for 69478. Pull request provided by Thomas\n    Krisch. (markt)\n  + Fix: The default servlet now rejects HTTP range requests when two or more\n    of the requested ranges overlap. Based on pull request #782 provided by\n    Chenjp. (markt)\n  + Fix: Enhance Content-Range verification for partial PUT requests handled\n    by the default servlet. Provided by Chenjp in pull request #778. (markt)\n  + Fix: Harmonize DataSourceStore lookup in the global resources to\n    optionally avoid the comp/env prefix which is usually not used there.\n    (remm)\n  + Fix: As required by RFC 9110, the HTTP Range header will now only be\n    processed for GET requests. Based on pull request #790 provided by Chenjp.\n    (markt)\n  + Fix: Deprecate the useAcceptRanges initialisation parameter for the\n    default servlet. It will be removed in Tomcat 12 onwards where it will\n    effectively be hard coded to true. (markt)\n  + Add: Add DataSource based property storage for the WebdavServlet. (remm)\n- Coyote\n  + Fix: Align encodedSolidusHandling with the Servlet specification. If the\n    pass-through mode is used, any %25 sequences will now also be passed\n    through to avoid errors and/or corruption when the application decodes the\n    path. (markt)\n- Jasper\n  + Fix: Further optimise EL evaluation of method parameters. Patch provided\n    by Paolo B. (markt)\n  + Fix: Follow-up to the fix for 69381. Apply the optimisation for method\n    lookup performance in expression language to an additional location.\n    (markt)\n- Web applications\n  + Fix: Documentation. Remove references to the ResourceParams element.\n    Support for ResourceParams was removed in Tomcat 5.5.x. (markt)\n  + Fix: Documentation. 69477: Correct name of attribute for RemoteIPFilter.\n    The attribute is internalProxies rather than allowedInternalProxies. Pull\n    request #786 (markt)\n  + Fix: Examples. Fix broken links when Servlet Request Info example is\n    called via a URL that includes a pathInfo component. (markt)\n  + Fix: Examples. Expand the obfuscation of session cookie values in the\n    request header example to JSON responses. (markt)\n  + Add: Examples. Add the ability to delete session attributes in the servlet\n    session example. (markt)\n  + Add: Examples. Add a hard coded limit of 10 attributes per session for the\n    servlet session example. (markt)\n  + Add: Examples. Add the ability to delete session attributes and add a hard\n    coded limit of 10 attributes per session for the JSP form authentication\n    example. (markt)\n  + Add: Examples. Limit the shopping cart example to only allow adding the\n    pre-defined items to the cart. (markt)\n  + Fix: Examples. Remove JSP calendar example. (markt)\n- Other\n  + Fix: 69465: Fix warnings during native image compilation using the Tomcat\n    embedded JARs. (markt)\n  + Update: Update Tomcat's fork of Commons DBCP to 2.13.0. (markt)\n  + Update: Update EasyMock to 5.5.0. (markt)\n  + Update: Update Checkstyle to 10.20.2. (markt)\n  + Update: Update BND to 7.1.0. (markt)\n  + Add: Improvements to French translations. (remm)\n  + Add: Improvements to Korean translations. (markt)\n  + Add: Improvements to Chinese translations. (markt)\n  + Add: Improvements to Japanese translations by tak7iji. (markt)\n",
	"affected": [
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Module for Web and Scripting 15 SP6",
				"name": "tomcat",
				"purl": "pkg:rpm/suse/tomcat&distro=SUSE%20Linux%20Enterprise%20Module%20for%20Web%20and%20Scripting%2015%20SP6"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.98-150200.74.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.98-150200.74.1",
						"tomcat-admin-webapps": "9.0.98-150200.74.1",
						"tomcat-el-3_0-api": "9.0.98-150200.74.1",
						"tomcat-jsp-2_3-api": "9.0.98-150200.74.1",
						"tomcat-lib": "9.0.98-150200.74.1",
						"tomcat-servlet-4_0-api": "9.0.98-150200.74.1",
						"tomcat-webapps": "9.0.98-150200.74.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise High Performance Computing 15 SP3-LTSS",
				"name": "tomcat",
				"purl": "pkg:rpm/suse/tomcat&distro=SUSE%20Linux%20Enterprise%20High%20Performance%20Computing%2015%20SP3-LTSS"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.98-150200.74.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.98-150200.74.1",
						"tomcat-admin-webapps": "9.0.98-150200.74.1",
						"tomcat-el-3_0-api": "9.0.98-150200.74.1",
						"tomcat-jsp-2_3-api": "9.0.98-150200.74.1",
						"tomcat-lib": "9.0.98-150200.74.1",
						"tomcat-servlet-4_0-api": "9.0.98-150200.74.1",
						"tomcat-webapps": "9.0.98-150200.74.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise High Performance Computing 15 SP4-ESPOS",
				"name": "tomcat",
				"purl": "pkg:rpm/suse/tomcat&distro=SUSE%20Linux%20Enterprise%20High%20Performance%20Computing%2015%20SP4-ESPOS"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.98-150200.74.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.98-150200.74.1",
						"tomcat-admin-webapps": "9.0.98-150200.74.1",
						"tomcat-el-3_0-api": "9.0.98-150200.74.1",
						"tomcat-jsp-2_3-api": "9.0.98-150200.74.1",
						"tomcat-lib": "9.0.98-150200.74.1",
						"tomcat-servlet-4_0-api": "9.0.98-150200.74.1",
						"tomcat-webapps": "9.0.98-150200.74.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise High Performance Computing 15 SP4-LTSS",
				"name": "tomcat",
				"purl": "pkg:rpm/suse/tomcat&distro=SUSE%20Linux%20Enterprise%20High%20Performance%20Computing%2015%20SP4-LTSS"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.98-150200.74.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.98-150200.74.1",
						"tomcat-admin-webapps": "9.0.98-150200.74.1",
						"tomcat-el-3_0-api": "9.0.98-150200.74.1",
						"tomcat-jsp-2_3-api": "9.0.98-150200.74.1",
						"tomcat-lib": "9.0.98-150200.74.1",
						"tomcat-servlet-4_0-api": "9.0.98-150200.74.1",
						"tomcat-webapps": "9.0.98-150200.74.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise High Performance Computing 15 SP5-ESPOS",
				"name": "tomcat",
				"purl": "pkg:rpm/suse/tomcat&distro=SUSE%20Linux%20Enterprise%20High%20Performance%20Computing%2015%20SP5-ESPOS"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.98-150200.74.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.98-150200.74.1",
						"tomcat-admin-webapps": "9.0.98-150200.74.1",
						"tomcat-el-3_0-api": "9.0.98-150200.74.1",
						"tomcat-jsp-2_3-api": "9.0.98-150200.74.1",
						"tomcat-lib": "9.0.98-150200.74.1",
						"tomcat-servlet-4_0-api": "9.0.98-150200.74.1",
						"tomcat-webapps": "9.0.98-150200.74.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise High Performance Computing 15 SP5-LTSS",
				"name": "tomcat",
				"purl": "pkg:rpm/suse/tomcat&distro=SUSE%20Linux%20Enterprise%20High%20Performance%20Computing%2015%20SP5-LTSS"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.98-150200.74.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.98-150200.74.1",
						"tomcat-admin-webapps": "9.0.98-150200.74.1",
						"tomcat-el-3_0-api": "9.0.98-150200.74.1",
						"tomcat-jsp-2_3-api": "9.0.98-150200.74.1",
						"tomcat-lib": "9.0.98-150200.74.1",
						"tomcat-servlet-4_0-api": "9.0.98-150200.74.1",
						"tomcat-webapps": "9.0.98-150200.74.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server 15 SP3-LTSS",
				"name": "tomcat",
				"purl": "pkg:rpm/suse/tomcat&distro=SUSE%20Linux%20Enterprise%20Server%2015%20SP3-LTSS"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.98-150200.74.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.98-150200.74.1",
						"tomcat-admin-webapps": "9.0.98-150200.74.1",
						"tomcat-el-3_0-api": "9.0.98-150200.74.1",
						"tomcat-jsp-2_3-api": "9.0.98-150200.74.1",
						"tomcat-lib": "9.0.98-150200.74.1",
						"tomcat-servlet-4_0-api": "9.0.98-150200.74.1",
						"tomcat-webapps": "9.0.98-150200.74.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server 15 SP4-LTSS",
				"name": "tomcat",
				"purl": "pkg:rpm/suse/tomcat&distro=SUSE%20Linux%20Enterprise%20Server%2015%20SP4-LTSS"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.98-150200.74.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.98-150200.74.1",
						"tomcat-admin-webapps": "9.0.98-150200.74.1",
						"tomcat-el-3_0-api": "9.0.98-150200.74.1",
						"tomcat-jsp-2_3-api": "9.0.98-150200.74.1",
						"tomcat-lib": "9.0.98-150200.74.1",
						"tomcat-servlet-4_0-api": "9.0.98-150200.74.1",
						"tomcat-webapps": "9.0.98-150200.74.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server 15 SP5-LTSS",
				"name": "tomcat",
				"purl": "pkg:rpm/suse/tomcat&distro=SUSE%20Linux%20Enterprise%20Server%2015%20SP5-LTSS"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.98-150200.74.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.98-150200.74.1",
						"tomcat-admin-webapps": "9.0.98-150200.74.1",
						"tomcat-el-3_0-api": "9.0.98-150200.74.1",
						"tomcat-jsp-2_3-api": "9.0.98-150200.74.1",
						"tomcat-lib": "9.0.98-150200.74.1",
						"tomcat-servlet-4_0-api": "9.0.98-150200.74.1",
						"tomcat-webapps": "9.0.98-150200.74.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server for SAP Applications 15 SP3",
				"name": "tomcat",
				"purl": "pkg:rpm/suse/tomcat&distro=SUSE%20Linux%20Enterprise%20Server%20for%20SAP%20Applications%2015%20SP3"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.98-150200.74.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.98-150200.74.1",
						"tomcat-admin-webapps": "9.0.98-150200.74.1",
						"tomcat-el-3_0-api": "9.0.98-150200.74.1",
						"tomcat-jsp-2_3-api": "9.0.98-150200.74.1",
						"tomcat-lib": "9.0.98-150200.74.1",
						"tomcat-servlet-4_0-api": "9.0.98-150200.74.1",
						"tomcat-webapps": "9.0.98-150200.74.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server for SAP Applications 15 SP4",
				"name": "tomcat",
				"purl": "pkg:rpm/suse/tomcat&distro=SUSE%20Linux%20Enterprise%20Server%20for%20SAP%20Applications%2015%20SP4"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.98-150200.74.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.98-150200.74.1",
						"tomcat-admin-webapps": "9.0.98-150200.74.1",
						"tomcat-el-3_0-api": "9.0.98-150200.74.1",
						"tomcat-jsp-2_3-api": "9.0.98-150200.74.1",
						"tomcat-lib": "9.0.98-150200.74.1",
						"tomcat-servlet-4_0-api": "9.0.98-150200.74.1",
						"tomcat-webapps": "9.0.98-150200.74.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server for SAP Applications 15 SP5",
				"name": "tomcat",
				"purl": "pkg:rpm/suse/tomcat&distro=SUSE%20Linux%20Enterprise%20Server%20for%20SAP%20Applications%2015%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.98-150200.74.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.98-150200.74.1",
						"tomcat-admin-webapps": "9.0.98-150200.74.1",
						"tomcat-el-3_0-api": "9.0.98-150200.74.1",
						"tomcat-jsp-2_3-api": "9.0.98-150200.74.1",
						"tomcat-lib": "9.0.98-150200.74.1",
						"tomcat-servlet-4_0-api": "9.0.98-150200.74.1",
						"tomcat-webapps": "9.0.98-150200.74.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Manager Server 4.3",
				"name": "tomcat",
				"purl": "pkg:rpm/suse/tomcat&distro=SUSE%20Manager%20Server%204.3"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.98-150200.74.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.98-150200.74.1",
						"tomcat-admin-webapps": "9.0.98-150200.74.1",
						"tomcat-el-3_0-api": "9.0.98-150200.74.1",
						"tomcat-jsp-2_3-api": "9.0.98-150200.74.1",
						"tomcat-lib": "9.0.98-150200.74.1",
						"tomcat-servlet-4_0-api": "9.0.98-150200.74.1",
						"tomcat-webapps": "9.0.98-150200.74.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Enterprise Storage 7.1",
				"name": "tomcat",
				"purl": "pkg:rpm/suse/tomcat&distro=SUSE%20Enterprise%20Storage%207.1"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.98-150200.74.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.98-150200.74.1",
						"tomcat-admin-webapps": "9.0.98-150200.74.1",
						"tomcat-el-3_0-api": "9.0.98-150200.74.1",
						"tomcat-jsp-2_3-api": "9.0.98-150200.74.1",
						"tomcat-lib": "9.0.98-150200.74.1",
						"tomcat-servlet-4_0-api": "9.0.98-150200.74.1",
						"tomcat-webapps": "9.0.98-150200.74.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "openSUSE:Leap 15.6",
				"name": "tomcat",
				"purl": "pkg:rpm/opensuse/tomcat&distro=openSUSE%20Leap%2015.6"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.98-150200.74.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.98-150200.74.1",
						"tomcat-admin-webapps": "9.0.98-150200.74.1",
						"tomcat-docs-webapp": "9.0.98-150200.74.1",
						"tomcat-el-3_0-api": "9.0.98-150200.74.1",
						"tomcat-embed": "9.0.98-150200.74.1",
						"tomcat-javadoc": "9.0.98-150200.74.1",
						"tomcat-jsp-2_3-api": "9.0.98-150200.74.1",
						"tomcat-jsvc": "9.0.98-150200.74.1",
						"tomcat-lib": "9.0.98-150200.74.1",
						"tomcat-servlet-4_0-api": "9.0.98-150200.74.1",
						"tomcat-webapps": "9.0.98-150200.74.1"
					}
				]
			}
		}
	],
	"references": [
		{
			"type": "ADVISORY",
			"url": "https://www.suse.com/support/update/announcement/2025/suse-su-20250058-1/"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1233435"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1234663"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1234664"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2024-50379"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2024-52317"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2024-54677"
		}
	]
}
