{
	"id": "SUSE-SU-2023:2579-1",
	"modified": "2023-06-21T11:52:13Z",
	"published": "2023-06-21T11:52:13Z",
	"related": [
		"CVE-2020-7753",
		"CVE-2021-3807",
		"CVE-2021-3918",
		"CVE-2021-43138",
		"CVE-2022-0155",
		"CVE-2022-27191",
		"CVE-2022-27664",
		"CVE-2022-31097",
		"CVE-2022-31107",
		"CVE-2022-32149",
		"CVE-2022-35957",
		"CVE-2022-36062",
		"CVE-2022-41715",
		"CVE-2022-46146",
		"CVE-2023-1387",
		"CVE-2023-1410"
	],
	"summary": "Security update for SUSE Manager Client Tools",
	"details": "This update fixes the following issues:\n\ngrafana:\n\n- Version update from 8.5.22 to 9.5.1 (jsc#PED-3694):\n  * Security fixes:\n    - CVE-2023-1410: grafana: Stored XSS in Graphite FunctionDescription tooltip (bsc#1209645)\n    - CVE-2023-1387: grafana: JWT URL-login flow leaks token to data sources through request parameter in proxy requests\n      (bnc#1210907)\n    - CVE-2022-36062: grafana: Fix RBAC folders/dashboards privilege escalation (bsc#1203596)\n    - CVE-2022-35957: grafana: Escalation from admin to server admin when auth proxy is used (bsc#1203597)\n    - CVE-2022-32149: Upgrade x/text to version unaffected by CVE-2022-32149 (bsc#1204501)\n    - CVE-2022-31107: grafana: OAuth account takeover (bsc#1201539)\n    - CVE-2022-31097: grafana: stored XSS vulnerability (bsc#1201535)\n    - CVE-2022-27664: go1.18,go1.19: net/http: handle server errors after sending GOAWAY (bsc#1203185)\n    - CVE-2022-0155: follow-redirects: Exposure of Private Personal Information to an Unauthorized Actor\n    - CVE-2021-43138: spacewalk-web: a malicious user can obtain privileges via the mapValues() method(bsc#1200480)\n    - CVE-2021-3918: json-schema is vulnerable to Improperly Controlled Modification of Object Prototype Attributes\n      ('Prototype Pollution') (bsc#1192696)\n    - CVE-2021-3807: node-ansi-regex: Inefficient Regular Expression Complexity in chalk/ansi-regex (bsc#1192154)\n    - CVE-2020-7753: nodejs-trim: Regular Expression Denial of Service (ReDoS) in trim function \n  * Important changes:\n    - Default named retention policies won't be used to query.\n      Users who have a default named retention policy in their influxdb database, have to rename it to something else.\n      To change the hardcoded retention policy in the dashboard.json, users must then select the right retention policy\n      from dropdown and save the panel/dashboard.\n    - Grafana Alerting rules with NoDataState configuration set to Alerting will now respect 'For' duration.\n    - Users who use LDAP role sync to only sync Viewer, Editor and Admin roles, but grant Grafana Server Admin role\n      manually will not be able to do that anymore. After this change, LDAP role sync will override any manual changes\n      to Grafana Server Admin role assignments. If grafana_admin is left unset in LDAP role mapping configuration, it\n      will default to false.\n    - The InfluxDB backend migration feature toggle (influxdbBackendMigration) has been reintroduced in this version\n      as issues were discovered with backend processing of InfluxDB data. Unless this feature toggle is enabled, all\n      InfluxDB data will be parsed in the frontend. This frontend processing is the default behavior. \n      In Grafana 9.4.4, InfluxDB data parsing started to be handled in the backend. If you have upgraded to 9.4.4\n      and then added new transformations on InfluxDB data, those panels will fail to render. To resolve this either:\n      Remove the affected panel and re-create it or edit the `time` field as `Time` in `panel.json` \n      or `dashboard.json`\n    - The `@grafana/ui` package helper function `selectOptionInTest` used in frontend tests has been removed as it\n      caused testing libraries to be bundled in the production code of Grafana. If you were using this helper function\n      in your tests please update your code accordingly.\n    - Removed deprecated `checkHealth` prop from the `@grafana/e2e` `addDataSource` configuration. Previously this\n      value defaulted to `false`, and has not been used in end-to-end tests since Grafana 8.0.3.\n    - Removed the deprecated `LegacyBaseMap`, `LegacyValueMapping`, `LegacyValueMap`, and `LegacyRangeMap` types, and\n      `getMappedValue` function from grafana-data. See the documentation for the migration.\n      This change fixes a bug in Grafana where intermittent failure of database, network between Grafana and the\n      database, or error in querying the database would cause all alert rules to be unscheduled in Grafana. \n      Following this change scheduled alert rules are not updated unless the query is successful.\n    - The `get_alert_rules_duration_seconds` metric has been renamed to `schedule_query_alert_rules_duration_seconds`\n    - Any secret (data sources credential, alert manager credential, etc, etc) created or modified with Grafana v9.0\n      won't be decryptable from any previous version (by default) because the way encrypted secrets are stored into the\n      database has changed. Although secrets created or modified with previous versions will still be decryptable by\n      Grafana v9.0.\n    - If required, although generally discouraged, the `disableEnvelopeEncryption` feature toggle can be enabled to\n      keep envelope encryption disabled once updating to Grafana\n    - In case of need to rollback to an earlier version of Grafana (i.e. Grafana v8.x) for any reason, after being\n      created or modified any secret with Grafana v9.0, the `envelopeEncryption` feature toggle will need to be enabled\n      to keep backwards compatibility (only from `v8.3.x` a bit unstable, from `8.5.x` stable).\n    - As a final attempt to deal with issues related with the aforementioned situations, the \n      `grafana-cli admin secrets-migration rollback` command has been designed to move back all the Grafana secrets\n      encrypted with envelope encryption to legacy encryption. So, after running that command it should be safe to\n      disable envelope encryption and/or roll back to a previous version of Grafana.\n      Alternatively or complementarily to all the points above, backing up the Grafana database before updating could\n      be a good idea to prevent disasters (although the risk of getting some secrets corrupted only applies to those \n      updates/created with after updating to Grafana v9.0).\n    - In Elasticsearch, browser access mode was deprecated in grafana 7.4.0 and removed in 9.0.0. If you used this mode\n      please switch to server access mode on the datasource configuration page.\n    - Environment variables passed from Grafana to external Azure plugins have been renamed:\n      `AZURE_CLOUD` renamed to `GFAZPL_AZURE_CLOUD`,\n      `AZURE_MANAGED_IDENTITY_ENABLED` renamed to `GFAZPL_MANAGED_IDENTITY_ENABLED`,\n      `AZURE_MANAGED_IDENTITY_CLIENT_ID` renamed to `GFAZPL_MANAGED_IDENTITY_CLIENT_ID`.\n      There are no known plugins which were relying on these variables. Moving forward plugins should read Azure\n      settings only via Grafana Azure SDK which properly handles old and new environment variables.\n    - Removes support for for ElasticSearch versions after their end-of-life, currently versions < 7.10.0.\n      To continue to use ElasticSearch data source, upgrade ElasticSearch to version 7.10.0+.\n    - Application Insights and Insight Analytics queries in Azure Monitor were deprecated in Grafana 8.0 and finally\n      removed in 9.0. Deprecated queries will no longer be executed.\n    - grafana/ui: Button now specifies a default type='button'.\n      The `Button` component provided by @grafana/ui now specifies a default `type='button'` when no type is provided.\n      In previous versions, if the attribute was not specified for buttons associated with a `<form>` the\n      default value was `submit` per the specification. You can preserve the old behavior by explicitly setting the\n      type attribute: `<Button type='submit' />`\n    - The `Rename by regex` transformation has been improved to allow global patterns of the form \n      `/<stringToReplace>/g`.\n      Depending on the regex match used, this may cause some transformations to behave slightly differently. You can\n      guarantee the same behaviour as before by wrapping the `match` string in forward slashes (`/`), e.g. `(.*)` would\n      become `/(.*)/`\n    - `<Select />` menus will now portal to the document body by default. This is to give more consistent\n      behaviour when positioning and overlaying. If you were setting`menuShouldPortal={true}` before you can safely \n      remove that prop and behaviour will be the same. If you weren't explicitly setting that prop, there should be no\n      visible changes in behaviour but your tests may need updating. If you were setting `menuShouldPortal={false}`\n      this will continue to prevent the menu from portalling.\n    - Grafana alerting endpoint prefixed with `api/v1/rule/test` that tests a rule against a Corte/Loki data source now\n      expects the data source UID as a path parameter instead of the data source numeric identifier.\n    - Grafana alerting endpoints prefixed with `api/prometheus/` that proxy requests to a Cortex/Loki data source now\n      expect the data source UID as a path parameter instead of the data source numeric identifier.\n    - Grafana alerting endpoints prefixed with `api/ruler/` that proxy requests to a Cortex/Loki data source now expect\n      the data source UID as a path parameter instead of the data\n    - Grafana alerting endpoints prefixed with `api/alertmanager/` that proxy requests to an Alertmanager now expect\n      the data source UID as a path parameter instead of the data source numeric identifier.\n    - The format of log messages have been updated, `lvl` is now `level` and `eror`and `dbug` has been replaced with\n      `error` and `debug`. The precision of timestamps has been increased.\n      To smooth the transition, it is possible to opt-out of the new log format by enabling the feature toggle\n      `oldlog`.\n      This option will be removed in a future minor release.\n    - In the Loki data source, the dataframe format used to represent Loki logs-data has been changed to a more\n      efficient format. The query-result is represented by a single dataframe with a 'labels' column, instead of the\n      separate dataframes for every labels-value. When displaying such data in explore, or in a logs-panel in the\n      dashboard will continue to work without changes, but if the data was loaded into a different dashboard-panel, or\n      Transforms were used, adjustments may be necessary. For example, if you used the 'labels to fields' \n      transformation with the logs data, please switch to the 'extract fields' transformation.\n  * Deprecations:\n    - The `grafana_database_conn_*` metrics are deprecated, and will be removed in a future version of Grafana. Use \n      the `go_sql_stats_*` metrics instead.\n    - Support for compact Explore URLs is deprecated and will be removed in a future release. Until then, when\n      navigating to Explore using the deprecated format the URLs are automatically converted. If you have\n      existing links pointing to Explore update them using the format generated by Explore upon navigation.\n      You can identify a compact URL by its format. Compact URLs have the left (and optionally right) url parameter as\n      an array of strings, for example `&left=['now-1h','now'...]`. The standard explore URLs follow a key/value\n      pattern, for example `&left={'datasource':'test'...}`. Please be sure to check your dashboards for any\n      hardcoded links to Explore and update them to the standard URL pattern.\n    - Chore: Remove deprecated DataSourceAPI methods.\n    - Data: Remove deprecated types and functions from valueMappings.\n    - Elasticsearch: Remove browser access mode.\n    - Elasticsearch: Remove support for versions after their end of the life (<7.10.0).\n    - Explore: Remove support for legacy, compact format URLs.\n    - Graph: Deprecate Graph (old) and make it no longer a visualization option for new panels.\n    - `setExploreQueryField`, `setExploreMetricsQueryField` and `setExploreLogsQueryField` are now deprecated and will\n      be removed in a future release. If you need to set a different query editor for Explore, conditionally render\n      based on `props.app` in your regular query editor.\n  * Changes:\n    - User: Fix externalUserId not being populated.\n      If you used any of these components please use them from grafana/experimental from now on:\n       - AccessoryButton\n       - EditorFieldGroup\n       - EditorHeader\n       - EditorField\n       - EditorRow\n       - EditorList\n       - EditorRows\n       - EditorSwitch\n       - FlexItem\n       - Stack\n       - InlineSelect\n       - InputGroup\n       - Space\n    - Starting with 9.1.0, existing heatmap panels will start using a new implementation. This can be disabled by\n      setting the `useLegacyHeatmapPanel` feature flag to true. It can be tested on a single dashbobard by adding\n      `?__feature.useLegacyHeatmapPanel=true` to any dashboard URL.\n    - Logger: Enable new logging format by default.\n    - Loki: Enable new visual query builder by default.\n    - Plugins: Remove plugin list panel.\n    - Install wrapper scripts under /usr/sbin\n    - Install actual binaries under /usr/libexec/grafana (or /usr/lib under older distributions) and create a simlink \n      for wrapper scripts and the service (which expect the binary to be under /usr/share/grafana/bin)\n    - Chore: Upgrade typescript to 4.6.4.\n\nmgr-daemon:\n\n- Version 4.3.7-1\n  * Update translation strings\n\nspacecmd:\n\n- Version 4.3.21-1\n  * fix argument parsing of distribution_update (bsc#1210458)\n- Version 4.3.20-1\n  * Display activation key details after executing the corresponding command (bsc#1208719)\n  * Show targetted packages before actually removing them (bsc#1207830)\n\nuyuni-common-libs:\n\n- Version 4.3.8-1\n  * Allow default component for context manager\n\nzypp-plugin-spacewalk:\n\n- 1.0.14\n  * SPEC file cleanup\n\n",
	"affected": [
		{
			"package": {
				"ecosystem": "SUSE:Manager Client Tools 12",
				"name": "grafana",
				"purl": "purl:rpm/suse/grafana&distro=SUSE%20Manager%20Client%20Tools%2012"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.5.1-1.48.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"grafana": "9.5.1-1.48.1",
						"mgr-daemon": "4.3.7-1.41.1",
						"python2-uyuni-common-libs": "4.3.8-1.33.1",
						"python2-zypp-plugin-spacewalk": "1.0.14-30.42.1",
						"spacecmd": "4.3.21-38.121.1",
						"zypp-plugin-spacewalk": "1.0.14-30.42.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Manager Client Tools 12",
				"name": "mgr-daemon",
				"purl": "purl:rpm/suse/mgr-daemon&distro=SUSE%20Manager%20Client%20Tools%2012"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.3.7-1.41.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"grafana": "9.5.1-1.48.1",
						"mgr-daemon": "4.3.7-1.41.1",
						"python2-uyuni-common-libs": "4.3.8-1.33.1",
						"python2-zypp-plugin-spacewalk": "1.0.14-30.42.1",
						"spacecmd": "4.3.21-38.121.1",
						"zypp-plugin-spacewalk": "1.0.14-30.42.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Manager Client Tools 12",
				"name": "spacecmd",
				"purl": "purl:rpm/suse/spacecmd&distro=SUSE%20Manager%20Client%20Tools%2012"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.3.21-38.121.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"grafana": "9.5.1-1.48.1",
						"mgr-daemon": "4.3.7-1.41.1",
						"python2-uyuni-common-libs": "4.3.8-1.33.1",
						"python2-zypp-plugin-spacewalk": "1.0.14-30.42.1",
						"spacecmd": "4.3.21-38.121.1",
						"zypp-plugin-spacewalk": "1.0.14-30.42.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Manager Client Tools 12",
				"name": "uyuni-common-libs",
				"purl": "purl:rpm/suse/uyuni-common-libs&distro=SUSE%20Manager%20Client%20Tools%2012"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.3.8-1.33.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"grafana": "9.5.1-1.48.1",
						"mgr-daemon": "4.3.7-1.41.1",
						"python2-uyuni-common-libs": "4.3.8-1.33.1",
						"python2-zypp-plugin-spacewalk": "1.0.14-30.42.1",
						"spacecmd": "4.3.21-38.121.1",
						"zypp-plugin-spacewalk": "1.0.14-30.42.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Manager Client Tools 12",
				"name": "zypp-plugin-spacewalk",
				"purl": "purl:rpm/suse/zypp-plugin-spacewalk&distro=SUSE%20Manager%20Client%20Tools%2012"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "1.0.14-30.42.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"grafana": "9.5.1-1.48.1",
						"mgr-daemon": "4.3.7-1.41.1",
						"python2-uyuni-common-libs": "4.3.8-1.33.1",
						"python2-zypp-plugin-spacewalk": "1.0.14-30.42.1",
						"spacecmd": "4.3.21-38.121.1",
						"zypp-plugin-spacewalk": "1.0.14-30.42.1"
					}
				]
			}
		}
	],
	"references": [
		{
			"type": "ADVISORY",
			"url": "https://www.suse.com/support/update/announcement/2023/suse-su-20232579-1/"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1047218"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1192154"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1192696"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1200480"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1201535"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1201539"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1203185"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1203596"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1203597"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1203599"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1204501"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1207830"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1208719"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1208965"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1209645"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1210458"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1210907"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2020-7753"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2021-3807"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2021-3918"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2021-43138"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-0155"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-27191"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-27664"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-31097"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-31107"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-32149"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-35957"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-36062"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-41715"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-46146"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-1387"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-1410"
		}
	]
}
