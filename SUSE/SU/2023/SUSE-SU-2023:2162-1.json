{
	"id": "SUSE-SU-2023:2162-1",
	"modified": "2023-05-10T16:07:03Z",
	"published": "2023-05-10T16:07:03Z",
	"related": [
		"CVE-2020-36691",
		"CVE-2022-43945",
		"CVE-2023-1611",
		"CVE-2023-1670",
		"CVE-2023-1855",
		"CVE-2023-1989",
		"CVE-2023-1990",
		"CVE-2023-1998",
		"CVE-2023-2124",
		"CVE-2023-2162",
		"CVE-2023-2483",
		"CVE-2023-30772"
	],
	"summary": "Security update for the Linux Kernel",
	"details": "The SUSE Linux Enterprise 12 SP5 AZURE kernel was updated to receive various security and bugfixes.\n\n\nThe following security bugs were fixed:\n\n- CVE-2023-2483: Fixed a use after free bug in emac_remove due caused by a race condition (bsc#1211037).\n- CVE-2023-2124: Fixed an out of bound access in the XFS subsystem that could have lead to denial-of-service or potentially privilege escalation (bsc#1210498).\n- CVE-2023-1670: Fixed a use after free in the Xircom 16-bit PCMCIA Ethernet driver. A local user could use this flaw to crash the system or potentially escalate their privileges on the system (bsc#1209871).\n- CVE-2023-2162: Fixed an use-after-free flaw in iscsi_sw_tcp_session_create (bsc#1210647).\n- CVE-2023-1998: Fixed a use after free during login when accessing the shost ipaddress (bsc#1210506).\n- CVE-2023-30772: Fixed a race condition and resultant use-after-free in da9150_charger_remove (bsc#1210329).\n- CVE-2023-1855: Fixed a use after free in xgene_hwmon_remove (bsc#1210202).\n- CVE-2023-1989: Fixed a use after free in btsdio_remove (bsc#1210336).\n- CVE-2023-1990: Fixed a use after free in ndlc_remove (bsc#1210337).\n- CVE-2022-43945: Fixed a buffer overflow in the NFSD implementation (bsc#1205128).\n- CVE-2023-1611: Fixed an use-after-free flaw in btrfs_search_slot (bsc#1209687).\n- CVE-2020-36691: Fixed a denial of service vulnerability via a nested Netlink policy with a back reference (bsc#1209777).\n\nThe following non-security bugs were fixed:\n\n- USB: dwc3: fix runtime pm imbalance on probe errors (git-fixes).\n- USB: dwc3: fix runtime pm imbalance on unbind (git-fixes).\n- ath10k: Fix error handling in case of CE pipe init failure (git-fixes).\n- ath10k: Fix missing frame timestamp for beacon/probe-resp (git-fixes).\n- ath10k: Fix the parsing error in service available event (git-fixes).\n- ath10k: add missing error return code in ath10k_pci_probe() (git-fixes).\n- ath10k: fix control-message timeout (git-fixes).\n- ath10k: fix division by zero in send path (git-fixes).\n- ath10k: fix memory overwrite of the WoWLAN wakeup packet pattern (git-fixes).\n- audit: improve audit queue handling when 'audit=1' on cmdline (bsc#1209969).\n- bpf, x86: Fix encoding for lower 8-bit registers in BPF_STX BPF_B (git-fixes).\n- cachefiles: Drop superfluous readpages aops NULL check (bsc#1210430).\n- cachefiles: Fix page leak in cachefiles_read_backing_file while vmscan is active (bsc#1210430).\n- cachefiles: Fix race between read_waiter and read_copier involving op->to_do (bsc#1210430).\n- cachefiles: Handle readpage error correctly (bsc#1210430).\n- cgroup/cpuset: Wake up cpuset_attach_wq tasks in cpuset_cancel_attach() (bsc#1210827).\n- cifs: fix negotiate context parsing (bsc#1210301).\n- cifs: fix open leaks in open_cached_dir() (bsc#1209342).\n- cred: allow get_cred() and put_cred() to be given NULL (bsc#1209887).\n- crypto: x86/ghash - fix unaligned access in ghash_setkey() (git-fixes).\n- drivers: net: lmc: fix case value for target abort error (git-fixes).\n- fscache, cachefiles: remove redundant variable 'cache' (bsc#1210430).\n- ftrace: Mark get_lock_parent_ip() __always_inline (git-fixes).\n- intel_pmc_ipc: restore ability to call functions with irq enabled (git-fixes).\n- ipmi: fix SSIF not responding under certain cond (git-fixes).\n- iwlwifi: Fix -EIO error code that is never returned (git-fixes).\n- iwlwifi: fw: make pos static in iwl_sar_get_ewrd_table() loop (git-fixes).\n- iwlwifi: pcie: fix locking when 'HW not ready' (git-fixes).\n- iwlwifi: pcie: gen2: fix locking when 'HW not ready' (git-fixes).\n- iwlwifi: pcie: reschedule in long-running memory reads (git-fixes).\n- kabi/severities: ignore KABI for NVMe, except nvme-fc (bsc#1174777).\n- kcm: Only allow TCP sockets to be attached to a KCM mux (git-fixes).\n- keys: Change keyring_serialise_link_sem to a mutex (bsc#1207088).\n- keys: Fix linking a duplicate key to a keyring's assoc_array (bsc#1207088).\n- keys: Hoist locking out of __key_link_begin() (bsc#1207088).\n- kretprobe: Prevent triggering kretprobe from within kprobe_flush_task (git-fixes).\n- l2tp: clean up stale tunnel or session in pppol2tp_connect's error path (git-fixes).\n- l2tp: fix pseudo-wire type for sessions created by pppol2tp_connect() (git-fixes).\n- l2tp: reject creation of non-PPP sessions on L2TPv2 tunnels (git-fixes).\n- net/ncsi: Do not return error on normal response (git-fixes).\n- net: axienet: Fix double deregister of mdio (git-fixes).\n- net: core: dst: Add kernel-doc for 'net' parameter (git-fixes).\n- net: core: dst_cache_set_ip6: Rename 'addr' parameter to 'saddr' for consistency (git-fixes).\n- net: phy: realtek: Use the dummy stubs for MMD register access for rtl8211b (git-fixes).\n- net: prevent ISA drivers from building on PPC32 (git-fixes).\n- net: usb: qmi_wwan: add Telit 0x1080 composition (git-fixes).\n- netfilter: nft_set_rbtree: fix parameter of __nft_rbtree_lookup() (git-fixes).\n- netfilter: x_tables: Add note about how to free percpu counters (git-fixes).\n- ntp: Limit TAI-UTC offset (git-fixes)\n- nvme-pci: do not WARN_ON in nvme_reset_work if ctrl.state is not RESETTING (git-fixes).\n- nvme-pci: fix doorbell buffer value endianness (git-fixes).\n- nvme: retain split access workaround for capability reads (git-fixes).\n- platform/x86: intel_pmc_ipc: Use devm_* calls in driver probe function (git-fixes).\n- platform/x86: intel_pmc_ipc: Use spin_lock to protect GCR updates (git-fixes).\n- powercap: fix possible name leak in powercap_register_zone() (git-fixes).\n- powerpc/numa: Consider the max NUMA node for migratable LPAR (bsc#1209999 ltc#202140 bsc#1190544 ltc#194520 bsc#1142685 ltc#179509 git-fixes).\n- powerpc/numa: Detect support for coregroup (bsc#1209999 ltc#202140 bsc#1142685 ltc#179509 git-fixes).\n- powerpc/numa: Limit possible nodes to within num_possible_nodes (bsc#1209999 ltc#202140 bsc#1142685 ltc#179509 git-fixes).\n- powerpc/numa: Restrict possible nodes based on platform (bsc#1209999 ltc#202140 bsc#1142685 ltc#179509 git-fixes).\n- powerpc/papr_scm: Update the NUMA distance table for the target node (bsc#1209999 ltc#202140 bsc#1142685 ltc#179509 git-fixes).\n- powerpc/pseries: Consolidate different NUMA distance update code paths (bsc#1209999 ltc#202140 bsc#1142685 ltc#179509 git-fixes).\n- powerpc/pseries: Rename TYPE1_AFFINITY to FORM1_AFFINITY (bsc#1209999 ltc#202140 bsc#1142685 ltc#179509 git-fixes).\n- powerpc/pseries: rename min_common_depth to primary_domain_index (bsc#1209999 ltc#202140 bsc#1142685 ltc#179509 git-fixes).\n- printk: Give error on attempt to set log buffer length to over 2G (bsc#1210534).\n- ring-buffer: Fix race while reader and writer are on the same page (git-fixes).\n- rpm/kernel-obs-build.spec.in: Remove SLE11 cruft\n- s390/percpu: add READ_ONCE() to arch_this_cpu_to_op_simple() (git-fixes).\n- scsi: qla2xxx: Fix memory leak in qla2x00_probe_one() (git-fixes).\n- scsi: qla2xxx: Perform lockless command completion in abort path (git-fixes).\n- sctp: do not free asoc when it is already dead in sctp_sendmsg (git-fixes).\n- sctp: return error if the asoc has been peeled off in sctp_wait_for_sndbuf (git-fixes).\n- sctp: use the right sk after waking up from wait_buf sleep (git-fixes).\n- struct ci_hdrc: hide new member at end (git-fixes).\n- struct wmi_svc_avail_ev_arg: new member to end (git-fixes).\n- timekeeping: Prevent 32bit truncation in (git-fixes)\n- tuntap: fix dividing by zero in ebpf queue selection (git-fixes).\n- uprobes/x86: Fix detection of 32-bit user mode (git-fixes).\n- usb/ohci-platform: Fix a warning when hibernating (git-fixes).\n- usb: chipidea: core: fix possible concurrent when switch role (git-fixes).\n- usb: chipidea: fix missing goto in `ci_hdrc_probe` (git-fixes).\n- usb: dwc3: core: fix kernel panic when do reboot (git-fixes).\n- usb: dwc3: gadget: Do not set IMI for no_interrupt (git-fixes).\n- usb: host: ohci-pxa27x: Fix and & vs | typo (git-fixes).\n- usb: storage: Add check for kcalloc (git-fixes).\n- usb: typec: Check for ops->exit instead of ops->enter in altmode_exit (git-fixes).\n- watchdog: pcwd_usb: Fix attempting to access uninitialized memory (git-fixes).\n- wifi: ath5k: fix an off by one check in ath5k_eeprom_read_freq_list() (git-fixes).\n- workqueue: Fix missing kfree(rescuer) in destroy_workqueue() (bsc#1210460).\n- workqueue: Fix spurious sanity check failures in destroy_workqueue() (bsc#1210460).\n- wq: handle VM suspension in stall detection (bsc#1210466).\n- x86, boot: Remove multiple copy of static function sanitize_boot_params() (git-fixes).\n- x86/apic: Fix arch_dynirq_lower_bound() bug for DT enabled machines (git-fixes).\n- x86/apic: Handle missing global clockevent gracefully (git-fixes bsc#1142926).\n- x86/apic: Soft disable APIC before initializing it (git-fixes).\n- x86/boot/compressed: Disable relocation relaxation (git-fixes).\n- x86/boot: Avoid using Intel mnemonics in AT&T syntax asm (git-fixes).\n- x86/bugs: Add Cannon lake to RETBleed affected CPU list (git-fixes).\n- x86/bugs: Enable STIBP for IBPB mitigated RETBleed (git-fixes).\n- x86/decoder: Add TEST opcode to Group3-2 (git-fixes).\n- x86/fpu: Prevent FPU state corruption (git-fixes).\n- x86/ioapic: Prevent inconsistent state when moving an interrupt (git-fixes).\n- x86/irq: Ensure PI wakeup handler is unregistered before module unload (git-fixes).\n- x86/kprobes: Fix to check non boostable prefixes correctly (git-fixes).\n- x86/kprobes: Restore BTF if the single-stepping is cancelled (git-fixes).\n- x86/lib/cpu: Address missing prototypes warning (git-fixes).\n- x86/mce/inject: Avoid out-of-bounds write when setting flags (git-fixes).\n- x86/mce: Lower throttling MCE messages' priority to warning (git-fixes).\n- x86/mm: Stop printing BRK addresses (git-fixes).\n- x86/mm: Use the correct function type for native_set_fixmap() (git-fixes).\n- x86/pkeys: Add check for pkey 'overflow' (git-fixes).\n- x86/reboot: Always use NMI fallback when shutdown via reboot vector IPI fails (git-fixes).\n- x86/speculation/mds: Mark mds_user_clear_cpu_buffers() __always_inline (git-fixes).\n- x86/sysfb: Fix check for bad VRAM size (git-fixes).\n- x86/tools/relocs: Fix non-POSIX regexp (git-fixes).\n- x86/tools: Fix objdump version check again (git-fixes).\n- x86/virt: Eat faults on VMXOFF in reboot flows (git-fixes).\n- x86/virt: Mark flags and memory as clobbered by VMXOFF (git-fixes).\n- x86: Do not let pgprot_modify() change the page encryption bit (git-fixes).\n- x86_64: Fix jiffies ODR violation (git-fixes).\n- xfrm: policy: use hlist rcu variants on insert (git-fixes).\n- xhci: also avoid the XHCI_ZERO_64B_REGS quirk with a passthrough iommu (git-fixes).\n- xhci: hide include of iommu.h (git-fixes).\n",
	"affected": [
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server 12 SP5",
				"name": "kernel-azure",
				"purl": "purl:rpm/suse/kernel-azure&distro=SUSE%20Linux%20Enterprise%20Server%2012%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.12.14-16.133.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"kernel-azure": "4.12.14-16.133.1",
						"kernel-azure-base": "4.12.14-16.133.1",
						"kernel-azure-devel": "4.12.14-16.133.1",
						"kernel-devel-azure": "4.12.14-16.133.1",
						"kernel-source-azure": "4.12.14-16.133.1",
						"kernel-syms-azure": "4.12.14-16.133.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server 12 SP5",
				"name": "kernel-source-azure",
				"purl": "purl:rpm/suse/kernel-source-azure&distro=SUSE%20Linux%20Enterprise%20Server%2012%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.12.14-16.133.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"kernel-azure": "4.12.14-16.133.1",
						"kernel-azure-base": "4.12.14-16.133.1",
						"kernel-azure-devel": "4.12.14-16.133.1",
						"kernel-devel-azure": "4.12.14-16.133.1",
						"kernel-source-azure": "4.12.14-16.133.1",
						"kernel-syms-azure": "4.12.14-16.133.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server 12 SP5",
				"name": "kernel-syms-azure",
				"purl": "purl:rpm/suse/kernel-syms-azure&distro=SUSE%20Linux%20Enterprise%20Server%2012%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.12.14-16.133.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"kernel-azure": "4.12.14-16.133.1",
						"kernel-azure-base": "4.12.14-16.133.1",
						"kernel-azure-devel": "4.12.14-16.133.1",
						"kernel-devel-azure": "4.12.14-16.133.1",
						"kernel-source-azure": "4.12.14-16.133.1",
						"kernel-syms-azure": "4.12.14-16.133.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server for SAP Applications 12 SP5",
				"name": "kernel-azure",
				"purl": "purl:rpm/suse/kernel-azure&distro=SUSE%20Linux%20Enterprise%20Server%20for%20SAP%20Applications%2012%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.12.14-16.133.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"kernel-azure": "4.12.14-16.133.1",
						"kernel-azure-base": "4.12.14-16.133.1",
						"kernel-azure-devel": "4.12.14-16.133.1",
						"kernel-devel-azure": "4.12.14-16.133.1",
						"kernel-source-azure": "4.12.14-16.133.1",
						"kernel-syms-azure": "4.12.14-16.133.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server for SAP Applications 12 SP5",
				"name": "kernel-source-azure",
				"purl": "purl:rpm/suse/kernel-source-azure&distro=SUSE%20Linux%20Enterprise%20Server%20for%20SAP%20Applications%2012%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.12.14-16.133.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"kernel-azure": "4.12.14-16.133.1",
						"kernel-azure-base": "4.12.14-16.133.1",
						"kernel-azure-devel": "4.12.14-16.133.1",
						"kernel-devel-azure": "4.12.14-16.133.1",
						"kernel-source-azure": "4.12.14-16.133.1",
						"kernel-syms-azure": "4.12.14-16.133.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server for SAP Applications 12 SP5",
				"name": "kernel-syms-azure",
				"purl": "purl:rpm/suse/kernel-syms-azure&distro=SUSE%20Linux%20Enterprise%20Server%20for%20SAP%20Applications%2012%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.12.14-16.133.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"kernel-azure": "4.12.14-16.133.1",
						"kernel-azure-base": "4.12.14-16.133.1",
						"kernel-azure-devel": "4.12.14-16.133.1",
						"kernel-devel-azure": "4.12.14-16.133.1",
						"kernel-source-azure": "4.12.14-16.133.1",
						"kernel-syms-azure": "4.12.14-16.133.1"
					}
				]
			}
		}
	],
	"references": [
		{
			"type": "ADVISORY",
			"url": "https://www.suse.com/support/update/announcement/2023/suse-su-20232162-1/"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1142685"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1142926"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1174777"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1190544"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1202353"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1205128"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1207088"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1209342"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1209687"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1209777"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1209871"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1209887"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1209969"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1209999"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1210202"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1210301"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1210329"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1210336"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1210337"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1210430"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1210460"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1210466"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1210469"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1210498"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1210506"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1210534"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1210647"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1210827"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1211037"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2020-36691"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2022-43945"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-1611"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-1670"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-1855"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-1989"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-1990"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-1998"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-2124"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-2162"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-2483"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-30772"
		}
	]
}
