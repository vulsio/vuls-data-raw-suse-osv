{
	"id": "SUSE-SU-2023:4032-1",
	"modified": "2023-10-10T12:20:18Z",
	"published": "2023-10-10T12:20:18Z",
	"related": [
		"CVE-2020-36766",
		"CVE-2023-1192",
		"CVE-2023-1206",
		"CVE-2023-1859",
		"CVE-2023-39192",
		"CVE-2023-39193",
		"CVE-2023-39194",
		"CVE-2023-42754",
		"CVE-2023-4622",
		"CVE-2023-4623",
		"CVE-2023-4881",
		"CVE-2023-4921"
	],
	"summary": "Security update for the Linux Kernel",
	"details": "\nThe SUSE Linux Enterprise 12 SP5 Azure kernel was updated to receive various security and bugfixes.\n\nThe following security bugs were fixed:\n\n- CVE-2023-39194: Fixed a flaw in the processing of state filters which could allow a local attackers to disclose sensitive information. (bsc#1215861)\n- CVE-2023-39193: Fixed a flaw in the processing of state filters which could allow a local attackers to disclose sensitive information. (bsc#1215860)\n- CVE-2023-39192: Fixed a flaw in the u32_match_it function which could allow a local attackers to disclose sensitive information. (bsc#1215858)\n- CVE-2023-42754: Fixed a null pointer dereference in ipv4_link_failure which could lead an authenticated attacker to trigger a DoS. (bsc#1215467)\n- CVE-2023-1206: Fixed a hash collision flaw in the IPv6 connection lookup table. A user located in the local network or with a high bandwidth connection can increase the CPU usage of the server that accepts IPV6 connections up to 95% (bsc#1212703).\n- CVE-2023-4921: Fixed a use-after-free vulnerability in the QFQ network scheduler which could be exploited to achieve local privilege escalatio (bsc#1215275).\n- CVE-2023-4622: Fixed a use-after-free vulnerability in the Unix domain sockets component which could be exploited to achieve local privilege escalation (bsc#1215117).\n- CVE-2023-4623: Fixed a use-after-free issue in the HFSC network scheduler which could be exploited to achieve local privilege escalation (bsc#1215115).\n- CVE-2020-36766: Fixed a potential information leak in in the CEC driver (bsc#1215299).\n- CVE-2023-1859: Fixed a use-after-free flaw in Xen transport for 9pfs which could be exploited to crash the system (bsc#1210169).\n- CVE-2023-4881: Fixed a out-of-bounds write flaw in the netfilter subsystem that could lead to potential information disclosure or a denial of service (bsc#1215221).\n- CVE-2023-1192: Fixed use-after-free in cifs_demultiplex_thread() (bsc#1208995).\n\nThe following non-security bugs were fixed:\n\n- 9p/trans_virtio: Remove sysfs file on probe failure (git-fixes).\n- arm64: insn: Fix ldadd instruction encoding (git-fixes)\n- arm64: kgdb: Set PSTATE.SS to 1 to re-enable single-step (git-fixes)\n- blk-mq: Add blk_mq_delay_run_hw_queues() API call (bsc#1214586).\n- blk-mq: In blk_mq_dispatch_rq_list() 'no budget' is a reason to kick (bsc#1214586).\n- blk-mq: Rerun dispatching in the case of budget contention (bsc#1214586).\n- check-for-config-changes: ignore BUILTIN_RETURN_ADDRESS_STRIPS_PAC (bsc#1214380). gcc7 on SLE 15 does not support this while later gcc does.\n- direct-io: allow direct writes to empty inodes (bsc#1215164).\n- Drivers: hv: vmbus: Do not dereference ACPI root object handle (git-fixes).\n- drm/ast: Fix DRAM init on AST2200 (bsc#1152446)\n- drm/client: Fix memory leak in drm_client_target_cloned (bsc#1152446) Backporting changes: \t* move changes to drm_fb_helper.c \t* context changes\n- drm/client: Send hotplug event after registering a client (bsc#1152446) Backporting changes: \t* send hotplug event from drm_client_add() \t* remove drm_dbg_kms()\n- drm/virtio: Fix GEM handle creation UAF (git-fixes).\n- drm/virtio: fix NULL pointer dereference in virtio_gpu_conn_get_modes (git-fixes).\n- ext4: avoid deadlock in fs reclaim with page writeback (bsc#1213016).\n- ext4: correct inline offset when handling xattrs in inode body (bsc#1214950).\n- ext4: fix wrong unit use in ext4_mb_clear_bb (bsc#1214943).\n- ext4: set goal start correctly in ext4_mb_normalize_request (bsc#1214940).\n- fbcon: Fix null-ptr-deref in soft_cursor (bsc#1154048)\n- fbdev: au1200fb: Fix missing IRQ check in au1200fb_drv_probe (bsc#1154048)\n- fbdev: imxfb: warn about invalid left/right margin (bsc#1154048)\n- fbdev: modedb: Add 1920x1080 at 60 Hz video mode (bsc#1154048)\n- fbdev: omapfb: lcd_mipid: Fix an error handling path in (bsc#1154048)\n- firmware: raspberrypi: fix possible memory leak in rpi_firmware_probe() (git-fixes).\n- firmware: raspberrypi: Introduce devm_rpi_firmware_get() (git-fixes).\n- firmware: raspberrypi: Keep count of all consumers (git-fixes).\n- fs: avoid softlockups in s_inodes iterators (bsc#1215165).\n- fuse: nlookup missing decrement in fuse_direntplus_link (bsc#1215607).\n- hv_utils: Fix passing zero to 'PTR_ERR' warning (git-fixes).\n- idr: fix param name in idr_alloc_cyclic() doc (bsc#1109837).\n- Input: psmouse - fix OOB access in Elantech protocol (git-fixes).\n- Input: raspberrypi-ts - fix refcount leak in rpi_ts_probe (git-fixes).\n- Input: xpad - add constants for GIP interface numbers (git-fixes).\n- Input: xpad - delete a Razer DeathAdder mouse VID/PID entry (git-fixes).\n- jbd2: check 'jh->b_transaction' before removing it from checkpoint (bsc#1214953).\n- jbd2: fix a race when checking checkpoint buffer busy (bsc#1214949).\n- jbd2: fix checkpoint cleanup performance regression (bsc#1214952).\n- jbd2: Fix wrongly judgement for buffer head removing while doing checkpoint (bsc#1214948).\n- jbd2: recheck chechpointing non-dirty buffer (bsc#1214945).\n- jbd2: remove t_checkpoint_io_list (bsc#1214946).\n- jbd2: remove unused function '__cp_buffer_busy' (bsc#1215162).\n- jbd2: restore t_checkpoint_io_list to maintain kABI (bsc#1214946).\n- jbd2: simplify journal_clean_one_cp_list() (bsc#1215207).\n- KVM: s390: vsie: Fix the initialization of the epoch extension (epdx) field (git-fixes bsc#1215897).\n- KVM: s390: vsie: fix the length of APCB bitmap (git-fixes bsc#1215898).\n- media: b2c2: Add missing check in flexcop_pci_isr: (git-fixes).\n- media: cec-notifier: clear cec_adap in cec_notifier_unregister (git-fixes).\n- media: cec: copy sequence field for the reply (git-fixes).\n- media: cec: integrate cec_validate_phys_addr() in cec-api.c (git-fixes).\n- media: cec: make cec_get_edid_spa_location() an inline function (git-fixes).\n- media: flexcop-usb: fix NULL-ptr deref in flexcop_usb_transfer_init() (git-fixes).\n- media: mceusb: return without resubmitting URB in case of -EPROTO error (git-fixes).\n- media: s5p_cec: decrement usage count if disabled (git-fixes).\n- media: uvcvideo: Increase UVC_CTRL_CONTROL_TIMEOUT to 5 seconds (git-fixes).\n- mkspec: Allow unsupported KMPs (bsc#1214386)\n- net: accept UFOv6 packages in virtio_net_hdr_to_skb (git-fixes).\n- net: check if protocol extracted by virtio_net_hdr_set_proto is correct (git-fixes).\n- net: do not allow gso_size to be set to GSO_BY_FRAGS (git-fixes).\n- net: ensure mac header is set in virtio_net_hdr_to_skb() (git-fixes).\n- net: tap: NULL pointer derefence in dev_parse_header_protocol when skb->dev is null (git-fixes).\n- net: usb: qmi_wwan: add Quectel EM05GV2 (git-fixes).\n- net: virtio_vsock: Enhance connection semantics (git-fixes).\n- net/mlx5: Fix size field in bufferx_reg struct (git-fixes).\n- NFS/pNFS: Report EINVAL errors from connect() to the server (git-fixes).\n- NFSD: fix change_info in NFSv4 RENAME replies (git-fixes).\n- NFSv4/pnfs: minor fix for cleanup path in nfs4_get_device_info (git-fixes).\n- powerpc/64s/exception: machine check use correct cfar for late handler (bsc#1065729).\n- powerpc/iommu: Fix notifiers being shared by PCI and VIO buses (bsc#1065729).\n- powerpc/xics: Remove unnecessary endian conversion (bsc#1065729).\n- quota: fix warning in dqgrab() (bsc#1214962).\n- quota: Properly disable quotas when add_dquot_ref() fails (bsc#1214961).\n- remoteproc: Add missing '\\n' in log messages (git-fixes).\n- remoteproc: Fix NULL pointer dereference in rproc_virtio_notify (git-fixes).\n- s390: add z16 elf platform (LTC#203790 bsc#1215954).\n- s390/dasd: fix hanging device after request requeue (LTC#203632 bsc#1215121).\n- s390/zcrypt: do not leak memory if dev_set_name() fails (git-fixes bsc#1215152).\n- scsi: qla2xxx: Fix NULL vs IS_ERR() bug for debugfs_create_dir() (git-fixes).\n- scsi: qla2xxx: Use raw_smp_processor_id() instead of smp_processor_id() (git-fixes).\n- scsi: zfcp: reduce flood of fcrscn1 trace records on multi-element RSCN (git-fixes bsc#1215149).\n- tools/virtio: fix the vringh test for virtio ring changes (git-fixes).\n- tracing: Reverse the order of trace_types_lock and event_mutex (git-fixes bsc#1215634).\n- udf: Fix extension of the last extent in the file (bsc#1214964).\n- udf: Fix file corruption when appending just after end of preallocated extent (bsc#1214965).\n- udf: Fix off-by-one error when discarding preallocation (bsc#1214966).\n- udf: Fix uninitialized array access for some pathnames (bsc#1214967).\n- usb: serial: option: add FOXCONN T99W368/T99W373 product (git-fixes).\n- usb: serial: option: add Quectel EM05G variant (0x030e) (git-fixes).\n- usb: typec: altmodes/displayport: Add pin assignment helper (git-fixes).\n- usb: typec: altmodes/displayport: Fix pin assignment calculation (git-fixes).\n- vhost_net: fix ubuf refcount incorrectly when sendmsg fails (git-fixes).\n- vhost: Do not call access_ok() when using IOTLB (git-fixes).\n- vhost: fix range used in translate_desc() (git-fixes).\n- vhost: Fix vhost_vq_reset() (git-fixes).\n- vhost: introduce helpers to get the size of metadata area (git-fixes).\n- vhost: missing __user tags (git-fixes).\n- vhost: Use vhost_get_used_size() in vhost_vring_set_addr() (git-fixes).\n- vhost: vsock: kick send_pkt worker once device is started (git-fixes).\n- vhost/net: Clear the pending messages when the backend is removed (git-fixes).\n- vhost/test: stop device before reset (git-fixes).\n- vhost/vsock: Fix error handling in vhost_vsock_init() (git-fixes).\n- virtio_balloon: prevent pfn array overflow (git-fixes).\n- virtio_mmio: Add missing PM calls to freeze/restore (git-fixes).\n- virtio_mmio: Restore guest page size on resume (git-fixes).\n- virtio_net: add checking sq is full inside xdp xmit (git-fixes).\n- virtio_net: fix memory leak inside XPD_TX with mergeable (git-fixes).\n- virtio_net: Fix probe failed when modprobe virtio_net (git-fixes).\n- virtio_net: Remove BUG() to avoid machine dead (git-fixes).\n- virtio_net: reorder some funcs (git-fixes).\n- virtio_net: separate the logic of checking whether sq is full (git-fixes).\n- virtio_net: suppress cpu stall when free_unused_bufs (git-fixes).\n- virtio_pci_modern: Fix the comment of virtio_pci_find_capability() (git-fixes).\n- virtio_pci: Support surprise removal of virtio pci device (git-fixes).\n- virtio_ring: Avoid loop when vq is broken in virtqueue_poll (git-fixes).\n- virtio-gpu: fix a missing check to avoid NULL dereference (git-fixes).\n- virtio-gpu: fix possible memory allocation failure (git-fixes).\n- virtio-net: execute xdp_do_flush() before napi_complete_done() (git-fixes).\n- virtio-net: fix race between ndo_open() and virtio_device_ready() (git-fixes).\n- virtio-net: fix race between set queues and probe (git-fixes).\n- virtio-net: fix the race between refill work and close (git-fixes).\n- virtio-net: set queues after driver_ok (git-fixes).\n- virtio-rng: make device ready before making request (git-fixes).\n- virtio: acknowledge all features before access (git-fixes).\n- vringh: Fix loop descriptors check in the indirect cases (git-fixes).\n- VSOCK: handle VIRTIO_VSOCK_OP_CREDIT_REQUEST (git-fixes).\n- vsock/virtio: avoid potential deadlock when vsock device remove (git-fixes).\n- vsock/virtio: enable VQs early on probe (git-fixes).\n- vsock/virtio: free queued packets when closing socket (git-fixes).\n- vsock/virtio: update credit only if socket is not closed (git-fixes).\n- word-at-a-time: use the same return type for has_zero regardless of endianness (bsc#1065729).\n- x86/hyperv: Fix NULL deref in set_hv_tscchange_cb() if Hyper-V setup fails (git-fixes).\n- x86/srso: Do not probe microcode in a guest (git-fixes).\n- x86/srso: Fix SBPB enablement for spec_rstack_overflow=off (git-fixes).\n- x86/srso: Fix srso_show_state() side effect (git-fixes).\n- x86/srso: Set CPUID feature bits independently of bug or mitigation status (git-fixes).\n- xen: remove a confusing comment on auto-translated guest I/O (git-fixes).\n",
	"affected": [
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server 12 SP5",
				"name": "kernel-azure",
				"purl": "pkg:rpm/suse/kernel-azure&distro=SUSE%20Linux%20Enterprise%20Server%2012%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.12.14-16.152.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"kernel-azure": "4.12.14-16.152.1",
						"kernel-azure-base": "4.12.14-16.152.1",
						"kernel-azure-devel": "4.12.14-16.152.1",
						"kernel-devel-azure": "4.12.14-16.152.1",
						"kernel-source-azure": "4.12.14-16.152.1",
						"kernel-syms-azure": "4.12.14-16.152.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server 12 SP5",
				"name": "kernel-source-azure",
				"purl": "pkg:rpm/suse/kernel-source-azure&distro=SUSE%20Linux%20Enterprise%20Server%2012%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.12.14-16.152.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"kernel-azure": "4.12.14-16.152.1",
						"kernel-azure-base": "4.12.14-16.152.1",
						"kernel-azure-devel": "4.12.14-16.152.1",
						"kernel-devel-azure": "4.12.14-16.152.1",
						"kernel-source-azure": "4.12.14-16.152.1",
						"kernel-syms-azure": "4.12.14-16.152.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server 12 SP5",
				"name": "kernel-syms-azure",
				"purl": "pkg:rpm/suse/kernel-syms-azure&distro=SUSE%20Linux%20Enterprise%20Server%2012%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.12.14-16.152.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"kernel-azure": "4.12.14-16.152.1",
						"kernel-azure-base": "4.12.14-16.152.1",
						"kernel-azure-devel": "4.12.14-16.152.1",
						"kernel-devel-azure": "4.12.14-16.152.1",
						"kernel-source-azure": "4.12.14-16.152.1",
						"kernel-syms-azure": "4.12.14-16.152.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server for SAP Applications 12 SP5",
				"name": "kernel-azure",
				"purl": "pkg:rpm/suse/kernel-azure&distro=SUSE%20Linux%20Enterprise%20Server%20for%20SAP%20Applications%2012%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.12.14-16.152.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"kernel-azure": "4.12.14-16.152.1",
						"kernel-azure-base": "4.12.14-16.152.1",
						"kernel-azure-devel": "4.12.14-16.152.1",
						"kernel-devel-azure": "4.12.14-16.152.1",
						"kernel-source-azure": "4.12.14-16.152.1",
						"kernel-syms-azure": "4.12.14-16.152.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server for SAP Applications 12 SP5",
				"name": "kernel-source-azure",
				"purl": "pkg:rpm/suse/kernel-source-azure&distro=SUSE%20Linux%20Enterprise%20Server%20for%20SAP%20Applications%2012%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.12.14-16.152.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"kernel-azure": "4.12.14-16.152.1",
						"kernel-azure-base": "4.12.14-16.152.1",
						"kernel-azure-devel": "4.12.14-16.152.1",
						"kernel-devel-azure": "4.12.14-16.152.1",
						"kernel-source-azure": "4.12.14-16.152.1",
						"kernel-syms-azure": "4.12.14-16.152.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server for SAP Applications 12 SP5",
				"name": "kernel-syms-azure",
				"purl": "pkg:rpm/suse/kernel-syms-azure&distro=SUSE%20Linux%20Enterprise%20Server%20for%20SAP%20Applications%2012%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "4.12.14-16.152.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"kernel-azure": "4.12.14-16.152.1",
						"kernel-azure-base": "4.12.14-16.152.1",
						"kernel-azure-devel": "4.12.14-16.152.1",
						"kernel-devel-azure": "4.12.14-16.152.1",
						"kernel-source-azure": "4.12.14-16.152.1",
						"kernel-syms-azure": "4.12.14-16.152.1"
					}
				]
			}
		}
	],
	"references": [
		{
			"type": "ADVISORY",
			"url": "https://www.suse.com/support/update/announcement/2023/suse-su-20234032-1/"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1109837"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1152446"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1154048"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1213016"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1214157"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1214380"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1214586"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1214940"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1214943"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1214945"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1214946"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1214948"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1214949"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1214950"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1214952"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1214953"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1215122"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1215136"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1215164"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1215165"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1215607"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1215877"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1215897"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1215898"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2020-36766"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-1192"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-1206"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-1859"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-39192"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-39193"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-39194"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-42754"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-4622"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-4623"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-4881"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-4921"
		}
	]
}
