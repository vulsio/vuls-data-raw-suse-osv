{
	"id": "SUSE-SU-2023:4129-1",
	"modified": "2023-10-19T07:52:28Z",
	"published": "2023-10-19T07:52:28Z",
	"related": [
		"CVE-2023-41080",
		"CVE-2023-44487"
	],
	"summary": "Security update for tomcat",
	"details": "This update for tomcat fixes the following issues:\n\nTomcat was updated to version 9.0.82 (jsc#PED-6376, jsc#PED-6377):\n    \n- Security issues fixed:\n\n  * CVE-2023-41080: Avoid protocol relative redirects in FORM authentication. (bsc#1214666)\n  * CVE-2023-44487: Fix HTTP/2 Rapid Reset Attack. (bsc#1216182)\n \n- Update to Tomcat 9.0.82:\n    \n  * Catalina\n    \n    + Add: 65770: Provide a lifecycle listener that will\n      automatically reload TLS configurations a set time before the\n      certificate is due to expire. This is intended to be used with\n      third-party tools that regularly renew TLS certificates.\n    + Fix: Fix handling of an error reading a context descriptor on\n      deployment.\n    + Fix: Fix rewrite rule qsd (query string discard) being ignored\n      if qsa was also use, while it should instead take precedence.\n    + Fix: 67472: Send fewer CORS-related headers when CORS is not\n      actually being engaged.\n    + Add: Improve handling of failures within recycle() methods.\n \n  * Coyote\n \n    + Fix: 67670: Fix regression with HTTP compression after code\n      refactoring.\n    + Fix: 67198: Ensure that the AJP connector attribute\n      tomcatAuthorization takes precedence over the\n      tomcatAuthentication attribute when processing an auth_type\n      attribute received from a proxy server.\n    + Fix: 67235: Fix a NullPointerException when an AsyncListener\n      handles an error with a dispatch rather than a complete.\n    + Fix: When an error occurs during asynchronous processing,\n      ensure that the error handling process is only triggered once\n      per asynchronous cycle.\n    + Fix: Fix logic issue trying to match no argument method in\n      IntropectionUtil.\n    + Fix: Improve thread safety around readNotify and writeNotify\n      in the NIO2 endpoint.\n    + Fix: Avoid rare thread safety issue accessing message digest\n      map.\n    + Fix: Improve statistics collection for upgraded connections\n      under load.\n    + Fix: Align validation of HTTP trailer fields with standard\n      fields.\n    + Fix: Improvements to HTTP/2 overhead protection (bsc#1216182,\n      CVE-2023-44487)\n  \n  * jdbc-pool\n  \n    + Fix: 67664: Correct a regression in the clean-up of\n      unnecessary use of fully qualified class names in 9.0.81\n      that broke the jdbc-pool.\n    \n  * Jasper\n  \n    + Fix: 67080: Improve performance of EL expressions in JSPs that\n      use implicit objects\n    \n- Update to Tomcat 9.0.80 (jsc#PED-6376, jsc#PED-6377):\n    \n  * Catalina:\n   \n    + Add RateLimitFilter which can be used to mitigate DoS and Brute Force attacks\n    + Move the management of the utility executor from the init()/destroy() methods of components to the start()/stop()\n      methods.\n    + Add org.apache.catalina.core.StandardVirtualThreadExecutor, a virtual thread based executor that may be used with\n      one or more Connectors to process requests received by those Connectors using virtual threads. This Executor\n      requires a minimum Java version of Java 21.\n    + Add a per session Semaphore to the PersistentValve that ensures that, within a single Tomcat instance, there is no\n      more than one concurrent request per session. Also expand the debug logging to include whether a request bypasses\n      the Valve and the reason if a request fails to obtain the per session Semaphore.\n    + Ensure that the default servlet correctly escapes file names in directory listings when using XML output.\n    + Add a numeric last modified field to the XML directory listings produced by the default servlet to enable sorting\n      in the XSLT.\n    + Attempts to lock a collection with WebDAV may incorrectly fail if a child collection has an expired lock.\n    + Deprecate the xssProtectionEnabled setting from the HttpHeaderSecurityFilter and change the default value to false\n      as support for the associated HTTP header has been removed from all major browsers.\n    + Add org.apache.catalina.core.ContextNamingInfoListener, a listener which creates context naming information\n      environment entries.\n    + Add org.apache.catalina.core.PropertiesRoleMappingListener, a listener which populates the context's role mapping\n      from a properties file.\n    + Fix an edge case where intra-web application symlinks would be followed if the web applications were deliberately\n      crafted to allow it even when allowLinking was set to false.\n    + Add utility config file resource lookup on Context to allow looking up resources from the webapp \n      (prefixed with webapp:) and make the resource lookup API more visible.\n    + Fix potential database connection leaks in DataSourceUserDatabase identified by Coverity Scan.\n    + Make parsing of ExtendedAccessLogValve patterns more robust.\n    + Fix failure trying to persist configuration for an internal credential handler.\n    + When serializing a session during the session presistence process, do not log a warning that null Principals are\n      not serializable.\n    + Catch NamingException in JNDIRealm#getPrincipal. It is used in Java up to 17 to signal closed connections.\n    + Use the same naming format in log messages for Connector instances as the associated ProtocolHandler instance.\n    + The parts count should also lower the actual maxParameterCount used for parsing parameters if parts are parsed\n      first.\n    + If an application or library sets both a non-500 error code and the javax.servlet.error.exception request\n      attribute, use the provided error code during error page processing rather than assuming an error code of 500.\n    + Update code comments and Tomcat output to use MiB for 1024 * 1024 bytes and KiB for 1024 bytes rather than MB and\n      kB.\n\n  * Coyote:\n\n    + Update the HTTP/2 implementation to use the prioritization scheme defined in RFC 9218 rather than the one defined\n      in RFC 7540.\n    + Fix not sending WINDOW_UPDATE when dataLength is ZERO on call SwallowedDataFramePayload.\n    + Restore the documented behaviour of MessageBytes.getType() that it returns the type of the original content rather\n      than reflecting the most recent conversion.\n    + Correct certificate logging on start-up so it differentiates between keystore based keys/certificates:\n      PEM file based keys/certificates and logs the relevant information for each.\n    + Refactor blocking reads and writes for the NIO connector to remove code paths that could allow a notification from\n      the Poller to be missed resuting in a timeout rather than the expected read or write.\n    + Refactor waiting for an HTTP/2 stream or connection window update to handle spurious wake-ups during the wait.\n    + Correct a regression introduced in 9.0.78 and use the correct constant when constructing the default value for the\n      certificateKeystoreFile attribute of an SSLHostConfigCertificate instance.\n    + Refactor HTTP/2 implementation to reduce pinning when using virtual threads.\n    + Pass through ciphers referring to an OpenSSL profile, such as PROFILE=SYSTEM instead of producing an error trying\n      to parse it.\n    + Ensure that AsyncListener.onError() is called after an error during asynchronous processing with HTTP/2.\n    + When using asynchronous I/O (the default for NIO and NIO2), include DATA frames when calculating the HTTP/2\n      overhead count to ensure that connections are not prematurely terminated.\n    + Correct a race condition that could cause spurious RST messages to be sent after the response had been written to\n      an HTTP/2 stream.\n\n  * WebSocket:\n\n    + Expand the validation of the value of the Sec-Websocket-Key header in the HTTP upgrade request that initiates a\n      WebSocket connection. The value is not decoded but it is checked for the correct length and that only valid\n      characters from the base64 alphabet are used.\n    + Improve handling of error conditions for the WebSocket server, particularly during Tomcat shutdown.\n    + Correct a regression in the fix for 66574 that meant the WebSocket session could return false for onOpen() before \n      the onClose() event had been completed.\n    + Fix a NullPointerException when flushing batched messages with compression enabled using permessage-deflate.\n    \n  * Web applications:\n\n    + Add RateLimitFilter which can be used to mitigate DoS and Brute Force attacks attribute in the configuration\n      section for the Digest authentication value.\n    + Documentation: Expand the security guidance to cover the embedded use case and add notes on the uses made of the\n      java.io.tmpdir system property.\n    + Documentation: Fix a typo in the name of the algorithms\n    + Documentation: Update documentation to use MiB for 1024 * 1024 bytes and KiB for 1024 bytes rather than MB and kB.\n\n  * jdbc-pool:\n\n    + Fix the releaseIdleCounter does not increment when testAllIdle releases them.\n    + Fix the ConnectionState state will be inconsistent with actual state on the connection when an exception occurs\n      while writing.\n\n  * Other:\n\n    + Update to Commons Daemon 1.3.4.\n    + Improvements to French translations.\n    + Update Checkstyle to 10.12.0.\n    + Update the packaged version of the Apache Tomcat Native Library to 1.2.37 to pick up the Windows binaries built\n      with with OpenSSL 1.1.1u.\n    + Include the Windows specific binary distributions in the files uploaded to Maven Central.\n    + Improvements to French translations.\n    + Improvements to Japanese translations.\n    + Update UnboundID to 6.0.9.\n    + Update Checkstyle to 10.12.1.\n    + Update BND to 6.4.1.66665:\n    + Update JSign to 5.0.\n    + Correct properties for JSign dependency.\n    + Align documentation for maxParameterCount to match hard-coded defaults.\n    + Update NSIS to 3.0.9.\n    + Update Checkstyle to 10.12.2.\n    + Improvements to French translations.\n    + Improvements to Japanese translations.\n    + Fix quoting so users can use the _RUNJAVA environment variable as intended on Windows when the path to the Java\n      executable contains spaces.\n    + Update Tomcat Native to 1.2.38 to pick up Windows binaries built with OpenSSL 1.1.1v.\n    + Improvements to Chinese translations.\n    + Improvements to French translations.\n    + Improvements to Japanese translations\n",
	"affected": [
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Module for Web and Scripting 15 SP4",
				"name": "tomcat",
				"purl": "purl:rpm/suse/tomcat&distro=SUSE%20Linux%20Enterprise%20Module%20for%20Web%20and%20Scripting%2015%20SP4"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.82-150200.46.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.82-150200.46.1",
						"tomcat-admin-webapps": "9.0.82-150200.46.1",
						"tomcat-el-3_0-api": "9.0.82-150200.46.1",
						"tomcat-jsp-2_3-api": "9.0.82-150200.46.1",
						"tomcat-lib": "9.0.82-150200.46.1",
						"tomcat-servlet-4_0-api": "9.0.82-150200.46.1",
						"tomcat-webapps": "9.0.82-150200.46.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Module for Web and Scripting 15 SP5",
				"name": "tomcat",
				"purl": "purl:rpm/suse/tomcat&distro=SUSE%20Linux%20Enterprise%20Module%20for%20Web%20and%20Scripting%2015%20SP5"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.82-150200.46.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.82-150200.46.1",
						"tomcat-admin-webapps": "9.0.82-150200.46.1",
						"tomcat-el-3_0-api": "9.0.82-150200.46.1",
						"tomcat-jsp-2_3-api": "9.0.82-150200.46.1",
						"tomcat-lib": "9.0.82-150200.46.1",
						"tomcat-servlet-4_0-api": "9.0.82-150200.46.1",
						"tomcat-webapps": "9.0.82-150200.46.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise High Performance Computing 15 SP2-LTSS",
				"name": "tomcat",
				"purl": "purl:rpm/suse/tomcat&distro=SUSE%20Linux%20Enterprise%20High%20Performance%20Computing%2015%20SP2-LTSS"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.82-150200.46.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.82-150200.46.1",
						"tomcat-admin-webapps": "9.0.82-150200.46.1",
						"tomcat-el-3_0-api": "9.0.82-150200.46.1",
						"tomcat-jsp-2_3-api": "9.0.82-150200.46.1",
						"tomcat-lib": "9.0.82-150200.46.1",
						"tomcat-servlet-4_0-api": "9.0.82-150200.46.1",
						"tomcat-webapps": "9.0.82-150200.46.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise High Performance Computing 15 SP3-ESPOS",
				"name": "tomcat",
				"purl": "purl:rpm/suse/tomcat&distro=SUSE%20Linux%20Enterprise%20High%20Performance%20Computing%2015%20SP3-ESPOS"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.82-150200.46.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.82-150200.46.1",
						"tomcat-admin-webapps": "9.0.82-150200.46.1",
						"tomcat-el-3_0-api": "9.0.82-150200.46.1",
						"tomcat-jsp-2_3-api": "9.0.82-150200.46.1",
						"tomcat-lib": "9.0.82-150200.46.1",
						"tomcat-servlet-4_0-api": "9.0.82-150200.46.1",
						"tomcat-webapps": "9.0.82-150200.46.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise High Performance Computing 15 SP3-LTSS",
				"name": "tomcat",
				"purl": "purl:rpm/suse/tomcat&distro=SUSE%20Linux%20Enterprise%20High%20Performance%20Computing%2015%20SP3-LTSS"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.82-150200.46.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.82-150200.46.1",
						"tomcat-admin-webapps": "9.0.82-150200.46.1",
						"tomcat-el-3_0-api": "9.0.82-150200.46.1",
						"tomcat-jsp-2_3-api": "9.0.82-150200.46.1",
						"tomcat-lib": "9.0.82-150200.46.1",
						"tomcat-servlet-4_0-api": "9.0.82-150200.46.1",
						"tomcat-webapps": "9.0.82-150200.46.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server 15 SP2-LTSS",
				"name": "tomcat",
				"purl": "purl:rpm/suse/tomcat&distro=SUSE%20Linux%20Enterprise%20Server%2015%20SP2-LTSS"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.82-150200.46.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.82-150200.46.1",
						"tomcat-admin-webapps": "9.0.82-150200.46.1",
						"tomcat-el-3_0-api": "9.0.82-150200.46.1",
						"tomcat-jsp-2_3-api": "9.0.82-150200.46.1",
						"tomcat-lib": "9.0.82-150200.46.1",
						"tomcat-servlet-4_0-api": "9.0.82-150200.46.1",
						"tomcat-webapps": "9.0.82-150200.46.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server 15 SP3-LTSS",
				"name": "tomcat",
				"purl": "purl:rpm/suse/tomcat&distro=SUSE%20Linux%20Enterprise%20Server%2015%20SP3-LTSS"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.82-150200.46.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.82-150200.46.1",
						"tomcat-admin-webapps": "9.0.82-150200.46.1",
						"tomcat-el-3_0-api": "9.0.82-150200.46.1",
						"tomcat-jsp-2_3-api": "9.0.82-150200.46.1",
						"tomcat-lib": "9.0.82-150200.46.1",
						"tomcat-servlet-4_0-api": "9.0.82-150200.46.1",
						"tomcat-webapps": "9.0.82-150200.46.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server for SAP Applications 15 SP2",
				"name": "tomcat",
				"purl": "purl:rpm/suse/tomcat&distro=SUSE%20Linux%20Enterprise%20Server%20for%20SAP%20Applications%2015%20SP2"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.82-150200.46.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.82-150200.46.1",
						"tomcat-admin-webapps": "9.0.82-150200.46.1",
						"tomcat-el-3_0-api": "9.0.82-150200.46.1",
						"tomcat-jsp-2_3-api": "9.0.82-150200.46.1",
						"tomcat-lib": "9.0.82-150200.46.1",
						"tomcat-servlet-4_0-api": "9.0.82-150200.46.1",
						"tomcat-webapps": "9.0.82-150200.46.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Linux Enterprise Server for SAP Applications 15 SP3",
				"name": "tomcat",
				"purl": "purl:rpm/suse/tomcat&distro=SUSE%20Linux%20Enterprise%20Server%20for%20SAP%20Applications%2015%20SP3"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.82-150200.46.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.82-150200.46.1",
						"tomcat-admin-webapps": "9.0.82-150200.46.1",
						"tomcat-el-3_0-api": "9.0.82-150200.46.1",
						"tomcat-jsp-2_3-api": "9.0.82-150200.46.1",
						"tomcat-lib": "9.0.82-150200.46.1",
						"tomcat-servlet-4_0-api": "9.0.82-150200.46.1",
						"tomcat-webapps": "9.0.82-150200.46.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Manager Server 4.2",
				"name": "tomcat",
				"purl": "purl:rpm/suse/tomcat&distro=SUSE%20Manager%20Server%204.2"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.82-150200.46.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.82-150200.46.1",
						"tomcat-admin-webapps": "9.0.82-150200.46.1",
						"tomcat-el-3_0-api": "9.0.82-150200.46.1",
						"tomcat-jsp-2_3-api": "9.0.82-150200.46.1",
						"tomcat-lib": "9.0.82-150200.46.1",
						"tomcat-servlet-4_0-api": "9.0.82-150200.46.1",
						"tomcat-webapps": "9.0.82-150200.46.1"
					}
				]
			}
		},
		{
			"package": {
				"ecosystem": "SUSE:Enterprise Storage 7.1",
				"name": "tomcat",
				"purl": "purl:rpm/suse/tomcat&distro=SUSE%20Enterprise%20Storage%207.1"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "9.0.82-150200.46.1"
						}
					]
				}
			],
			"ecosystem_specific": {
				"binaries": [
					{
						"tomcat": "9.0.82-150200.46.1",
						"tomcat-admin-webapps": "9.0.82-150200.46.1",
						"tomcat-el-3_0-api": "9.0.82-150200.46.1",
						"tomcat-jsp-2_3-api": "9.0.82-150200.46.1",
						"tomcat-lib": "9.0.82-150200.46.1",
						"tomcat-servlet-4_0-api": "9.0.82-150200.46.1",
						"tomcat-webapps": "9.0.82-150200.46.1"
					}
				]
			}
		}
	],
	"references": [
		{
			"type": "ADVISORY",
			"url": "https://www.suse.com/support/update/announcement/2023/suse-su-20234129-1/"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1214666"
		},
		{
			"type": "REPORT",
			"url": "https://bugzilla.suse.com/1216182"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-41080"
		},
		{
			"type": "WEB",
			"url": "https://www.suse.com/security/cve/CVE-2023-44487"
		}
	]
}
